<!DOCTYPE html>
<html lang="en" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="DudeGuuud" />
  <!-- Open Graph Description ç®€çŸ­æ‘˜è¦-->
  
  <!-- ç”¨äºæœç´¢å¼•æ“çš„æ–‡ç« æ‘˜è¦ -->
  
  <meta name="description" content="&#34;the quieter you become, the more you are able to hear&#34;" />
  
  
  
  <title>
    
      SUI MOVE CTF 2025 (1-4) Write Up 
      
      
      |
    
     Dude&#39;s Blog
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- ä»£ç å—é£æ ¼ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" />
  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="/plugins/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="/plugins/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="/plugins/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/rss.xml" title="Dude's Blog" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- å¤´åƒå–æ¶ˆæ‡’åŠ è½½ï¼Œæ·»åŠ no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">DudeGuuud</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/categories/">
          <a href="/categories/">Categories</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- æ–‡ç« è¯¦æƒ…é¡µï¼Œå±•ç¤ºæ–‡ç« å…·ä½“å†…å®¹ï¼Œurlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
<!-- åŒæ—¶ä¸ºã€Œæ ‡ç­¾tagã€ï¼Œã€Œæœ‹å‹friendã€ï¼Œã€Œåˆ†ç±»categoriesã€ï¼Œã€Œå…³äºaboutã€é¡µé¢çš„æ‰¿è½½é¡µé¢ï¼Œå…·ä½“å±•ç¤ºå–å†³äºpage.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="/plugins/mathjax/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="/plugins/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- æ–‡ç« å†…å®¹é¡µ urlå½¢å¼ï¼šhttps://yoursite/æ–‡ç« æ ‡é¢˜/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">SUI MOVE CTF 2025 (1-4) Write Up</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
          2025-08-05 16:32:21
        </span>
        
      </div>
      <div class="markdown-body">
        <h1 id="Sui-Move-CTF-2025-1-4-WriteUp"><a href="#Sui-Move-CTF-2025-1-4-WriteUp" class="headerlink" title="Sui Move CTF 2025(1-4) WriteUp"></a>Sui Move CTF 2025(1-4) WriteUp</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æœ¬æ–‡æ¡£åŒ…å«äº†å››é“Sui Move CTFæŒ‘æˆ˜çš„å®Œæ•´è§£é¢˜è¿‡ç¨‹ï¼Œæ¶µç›–äº†æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨ã€ç®—æ³•åˆ†æã€å¯†ç å­¦æ”»å‡»å’Œè·¯å¾„æœç´¢ç­‰å¤šä¸ªæŠ€æœ¯é¢†åŸŸã€‚æ¯ä¸ªé¢˜ç›®éƒ½ä¿ç•™äº†å®Œæ•´çš„æŠ€æœ¯ç»†èŠ‚ã€ä»£ç å®ç°å’Œè§£é¢˜è¿‡ç¨‹ã€‚</p>
<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><ol>
<li><a href="#1-%E5%86%92%E9%99%A9%E6%B8%B8%E6%88%8F">å†’é™©æ¸¸æˆ - æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨</a></li>
<li><a href="#2-%E5%BC%BA%E7%9B%97%E6%B8%B8%E6%88%8F">å¼ºç›—æ¸¸æˆ - åŠ¨æ€è§„åˆ’ç®—æ³•</a></li>
<li><a href="#3-%E6%81%A2%E5%A4%8D%E5%AF%86%E9%92%A5">æ¢å¤å¯†é’¥ - æ ¼ç†è®ºå¯†ç å­¦</a></li>
<li><a href="#4-%E8%BF%B7%E5%AE%AB%E6%B8%B8%E6%88%8F">è¿·å®«æ¸¸æˆ - è·¯å¾„æœç´¢ç®—æ³•</a></li>
</ol>
<hr>
<h1 id="1-å†’é™©æ¸¸æˆ"><a href="#1-å†’é™©æ¸¸æˆ" class="headerlink" title="1. å†’é™©æ¸¸æˆ"></a>1. å†’é™©æ¸¸æˆ</h1><h2 id="æŒ‘æˆ˜æ¦‚è¿°"><a href="#æŒ‘æˆ˜æ¦‚è¿°" class="headerlink" title="æŒ‘æˆ˜æ¦‚è¿°"></a>æŒ‘æˆ˜æ¦‚è¿°</h2><p>è¿™æ˜¯ä¸€ä¸ªåŸºäºSui Moveæ™ºèƒ½åˆçº¦çš„CTFæŒ‘æˆ˜ï¼Œç›®æ ‡æ˜¯é€šè¿‡åˆ©ç”¨åˆçº¦æ¼æ´è·å–Flagã€‚æŒ‘æˆ˜æ¶‰åŠä¸€ä¸ªå†’é™©æ¸¸æˆï¼Œç©å®¶éœ€è¦æ§åˆ¶è‹±é›„å‡»è´¥æ€ªç‰©æ¥è·å¾—tokenï¼Œæœ€ç»ˆè´­ä¹°å®ç®±è·å–Flagã€‚</p>
<h2 id="åˆçº¦åˆ†æ"><a href="#åˆçº¦åˆ†æ" class="headerlink" title="åˆçº¦åˆ†æ"></a>åˆçº¦åˆ†æ</h2><h3 id="æ ¸å¿ƒåˆçº¦ç»“æ„"><a href="#æ ¸å¿ƒåˆçº¦ç»“æ„" class="headerlink" title="æ ¸å¿ƒåˆçº¦ç»“æ„"></a>æ ¸å¿ƒåˆçº¦ç»“æ„</h3><p>æŒ‘æˆ˜åŒ…å«ä¸‰ä¸ªä¸»è¦æ¨¡å—ï¼š</p>
<ul>
<li><code>adventure.move</code> - ä¸»è¦æ¸¸æˆé€»è¾‘</li>
<li><code>hero.move</code> - è‹±é›„ç³»ç»Ÿ</li>
<li><code>inventory.move</code> - ç‰©å“å’ŒFlagç³»ç»Ÿ</li>
</ul>
<h3 id="å…³é”®æ¼æ´å‘ç°"><a href="#å…³é”®æ¼æ´å‘ç°" class="headerlink" title="å…³é”®æ¼æ´å‘ç°"></a>å…³é”®æ¼æ´å‘ç°</h3><h4 id="1-ä½“åŠ›æ¶ˆè€—æ¼æ´"><a href="#1-ä½“åŠ›æ¶ˆè€—æ¼æ´" class="headerlink" title="1. ä½“åŠ›æ¶ˆè€—æ¼æ´"></a>1. ä½“åŠ›æ¶ˆè€—æ¼æ´</h4><p>åœ¨ <code>slay_boar_king</code> å‡½æ•°ä¸­å‘ç°å…³é”®æ¼æ´ï¼š</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">entry fun <span class="token function">slay_boar_king</span><span class="token punctuation">(</span>clock<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">clock<span class="token punctuation">::</span></span><span class="token class-name">Clock</span><span class="token punctuation">,</span> usersTokenAmount<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">UsersTokenAmount</span><span class="token punctuation">,</span> hero<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Hero</span><span class="token punctuation">,</span> ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">TxContext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// ...</span>
    <span class="token comment">//hero::decrease_stamina(hero, 2);  // è¿™è¡Œè¢«æ³¨é‡Šæ‰äº†ï¼</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å½±å“</strong>: å‡»è´¥é‡çŒªç‹ä¸æ¶ˆè€—ä½“åŠ›ï¼Œå¯ä»¥æ— é™æ¬¡æ”»å‡»ã€‚</p>
<h4 id="2-æ—¶é—´æˆ³ä¾èµ–æ¼æ´"><a href="#2-æ—¶é—´æˆ³ä¾èµ–æ¼æ´" class="headerlink" title="2. æ—¶é—´æˆ³ä¾èµ–æ¼æ´"></a>2. æ—¶é—´æˆ³ä¾èµ–æ¼æ´</h4><p>tokenå¥–åŠ±åŸºäºæ—¶é—´æˆ³ï¼š</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">if</span> <span class="token punctuation">(</span>fight_result <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> current_timestamp <span class="token operator">=</span> <span class="token namespace">clock<span class="token punctuation">::</span></span><span class="token function">timestamp_ms</span><span class="token punctuation">(</span>clock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> d100 <span class="token operator">=</span> current_timestamp <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>d100 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// å¢åŠ 5ä¸ªtoken</span>
        <span class="token operator">*</span>current_balance <span class="token operator">=</span> <span class="token operator">*</span>current_balance <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// å‡å°‘5ä¸ªtoken</span>
        <span class="token operator">*</span>current_balance <span class="token operator">=</span> <span class="token operator">*</span>current_balance <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>å½±å“</strong>: åªæœ‰å½“ <code>timestamp % 3 == 1</code> æ—¶æ‰èƒ½è·å¾—tokenå¥–åŠ±ã€‚</p>
<h4 id="3-è®¡è´¹é”™è¯¯æ¼æ´"><a href="#3-è®¡è´¹é”™è¯¯æ¼æ´" class="headerlink" title="3. è®¡è´¹é”™è¯¯æ¼æ´"></a>3. è®¡è´¹é”™è¯¯æ¼æ´</h4><p>åœ¨ <code>buy_box</code> å‡½æ•°ä¸­ï¼š</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token operator">*</span>current_balance <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token constant">ERROR_NO_MONEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// æ£€æŸ¥200</span>
<span class="token operator">*</span>current_balance <span class="token operator">=</span> <span class="token operator">*</span>current_balance <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">;</span>         <span class="token comment">// ä½†åªæ‰£é™¤100</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>å½±å“</strong>: æ£€æŸ¥éœ€è¦200ä¸ªtokenä½†å®é™…åªæ‰£é™¤100ä¸ªã€‚</p>
<h2 id="æ”»å‡»ç­–ç•¥"><a href="#æ”»å‡»ç­–ç•¥" class="headerlink" title="æ”»å‡»ç­–ç•¥"></a>æ”»å‡»ç­–ç•¥</h2><h3 id="é˜¶æ®µ1-è‹±é›„æˆ˜æ–—åŠ›æå‡"><a href="#é˜¶æ®µ1-è‹±é›„æˆ˜æ–—åŠ›æå‡" class="headerlink" title="é˜¶æ®µ1: è‹±é›„æˆ˜æ–—åŠ›æå‡"></a>é˜¶æ®µ1: è‹±é›„æˆ˜æ–—åŠ›æå‡</h3><p>å‘ç°è‹±é›„åˆå§‹å±æ€§ä¸è¶³ä»¥å‡»è´¥é‡çŒªç‹ï¼š</p>
<ul>
<li>åˆå§‹strength: 10</li>
<li>é‡çŒªç‹defense: 10-15</li>
</ul>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>: å‡çº§è‹±é›„ç³»ç»Ÿ</p>
<ul>
<li>å‡»è´¥æ™®é€šé‡çŒªè·å¾—ç»éªŒï¼ˆæ¯æ¬¡+10ç»éªŒï¼‰</li>
<li>100ç»éªŒå¯å‡çº§ï¼Œå‡çº§åstrengthå¢åŠ 30ç‚¹</li>
</ul>
<h3 id="é˜¶æ®µ2-PTBæ—¶é—´æˆ³æ”»å‡»"><a href="#é˜¶æ®µ2-PTBæ—¶é—´æˆ³æ”»å‡»" class="headerlink" title="é˜¶æ®µ2: PTBæ—¶é—´æˆ³æ”»å‡»"></a>é˜¶æ®µ2: PTBæ—¶é—´æˆ³æ”»å‡»</h3><p>åˆ©ç”¨Programmable Transaction Block (PTB)ç¡®ä¿æ‰€æœ‰æ“ä½œä½¿ç”¨ç›¸åŒæ—¶é—´æˆ³ï¼š</p>
<ol>
<li>ç­‰å¾…æœ‰åˆ©æ—¶é—´æˆ³ï¼ˆ<code>timestamp % 3 == 1</code>ï¼‰</li>
<li>åœ¨å•ä¸ªPTBä¸­æ‰§è¡Œ20æ¬¡ <code>slay_boar_king</code>è°ƒç”¨</li>
<li>æ¯æ¬¡æˆåŠŸ+5 tokenï¼Œä»100å¢åŠ åˆ°200</li>
</ol>
<h3 id="é˜¶æ®µ3-è´­ä¹°å®ç®±è·å–Flag"><a href="#é˜¶æ®µ3-è´­ä¹°å®ç®±è·å–Flag" class="headerlink" title="é˜¶æ®µ3: è´­ä¹°å®ç®±è·å–Flag"></a>é˜¶æ®µ3: è´­ä¹°å®ç®±è·å–Flag</h3><ol>
<li>åˆ©ç”¨è®¡è´¹é”™è¯¯è´­ä¹°å®ç®±ï¼ˆæ£€æŸ¥200ä½†åªæ‰£100ï¼‰</li>
<li>è°ƒç”¨ <code>get_flag</code>å‡½æ•°è·å–Flagäº‹ä»¶</li>
</ol>
<h2 id="æ”»å‡»å®ç°"><a href="#æ”»å‡»å®ç°" class="headerlink" title="æ”»å‡»å®ç°"></a>æ”»å‡»å®ç°</h2><h3 id="è‹±é›„å‡çº§è„šæœ¬"><a href="#è‹±é›„å‡çº§è„šæœ¬" class="headerlink" title="è‹±é›„å‡çº§è„šæœ¬"></a>è‹±é›„å‡çº§è„šæœ¬</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># å‡»è´¥30åªæ™®é€šé‡çŒªè·å¾—ç»éªŒ</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    sui client call <span class="token parameter variable">--package</span> <span class="token variable">$PACKAGE_ID</span> <span class="token parameter variable">--module</span> adventure <span class="token parameter variable">--function</span> slay_boar <span class="token punctuation">\</span>
        <span class="token parameter variable">--args</span> <span class="token variable">$HERO_ID</span> --gas-budget <span class="token number">20000000</span>
<span class="token keyword">done</span>

<span class="token comment"># å‡çº§è‹±é›„</span>
sui client call <span class="token parameter variable">--package</span> <span class="token variable">$PACKAGE_ID</span> <span class="token parameter variable">--module</span> hero <span class="token parameter variable">--function</span> level_up <span class="token punctuation">\</span>
    <span class="token parameter variable">--args</span> <span class="token variable">$HERO_ID</span> --gas-budget <span class="token number">20000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="PTBæ‰¹é‡æ”»å‡»è„šæœ¬"><a href="#PTBæ‰¹é‡æ”»å‡»è„šæœ¬" class="headerlink" title="PTBæ‰¹é‡æ”»å‡»è„šæœ¬"></a>PTBæ‰¹é‡æ”»å‡»è„šæœ¬</h3><p>æ ¸å¿ƒæ”»å‡»è„šæœ¬ <code>ptb_batch_attack.sh</code>ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token comment"># åˆçº¦é…ç½®</span>
<span class="token assign-left variable">PACKAGE_ID</span><span class="token operator">=</span><span class="token string">"0x539e759491e4093d8438c03daf03217d2b73920f44eb44e37421583ac2bae05d"</span>
<span class="token assign-left variable">HERO_ID</span><span class="token operator">=</span><span class="token string">"0xbf93ccc1f6776e92e70130b287c60fe7c1938b62490884faf4af17ac8f3bc134"</span>
<span class="token assign-left variable">USERS_TOKEN_AMOUNT_ID</span><span class="token operator">=</span><span class="token string">"0xa105e23ff0fd60bff8b216e2b409745ccaa4e29d996f5cc27fffd4aab1fdfe45"</span>
<span class="token assign-left variable">CLOCK_ID</span><span class="token operator">=</span><span class="token string">"0x6"</span>

<span class="token comment"># PTBæ”»å‡»å‡½æ•°</span>
<span class="token function-name function">execute_ptb_attack</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token builtin class-name">local</span> <span class="token assign-left variable">batch_size</span><span class="token operator">=</span><span class="token variable">$1</span>
    <span class="token assign-left variable">PTB_CMD</span><span class="token operator">=</span><span class="token string">"sui client ptb"</span>
  
    <span class="token comment"># æ„å»º20æ¬¡slay_boar_kingè°ƒç”¨</span>
    <span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>batch_size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
        <span class="token assign-left variable">PTB_CMD</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$PTB_CMD</span> --move-call <span class="token variable">$PACKAGE_ID</span>::adventure::slay_boar_king <span class="token entity" title="\&quot;">\"</span><span class="token entity" title="\&quot;">\"</span> @<span class="token variable">$CLOCK_ID</span> @<span class="token variable">$USERS_TOKEN_AMOUNT_ID</span> @<span class="token variable">$HERO_ID</span>"</span>
    <span class="token keyword">done</span>
  
    <span class="token assign-left variable">PTB_CMD</span><span class="token operator">=</span><span class="token string">"<span class="token variable">$PTB_CMD</span> --gas-budget 100000000"</span>
    <span class="token assign-left variable">RESULT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">eval</span> $PTB_CMD <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span><span class="token variable">)</span></span>
  
    <span class="token comment"># æ£€æŸ¥Amountäº‹ä»¶</span>
    <span class="token keyword">if</span> <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$RESULT</span>"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-q</span> <span class="token string">"Amount"</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token assign-left variable">AMOUNT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$RESULT</span>"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-A</span> <span class="token number">5</span> <span class="token string">"Amount"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"amount"</span> <span class="token operator">|</span> <span class="token function">tail</span> <span class="token parameter variable">-1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-o</span> <span class="token string">'[0-9]\+'</span><span class="token variable">)</span></span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$AMOUNT</span>"</span> <span class="token parameter variable">-ge</span> <span class="token number">200</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token builtin class-name">return</span> <span class="token number">0</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">fi</span>
    <span class="token builtin class-name">return</span> <span class="token number">1</span>
<span class="token punctuation">&#125;</span>

<span class="token comment"># ä¸»æ”»å‡»å¾ªç¯</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">attempt</span> <span class="token keyword">in</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">seq</span> <span class="token number">1</span> <span class="token number">100</span><span class="token variable">)</span></span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">TIMESTAMP</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
    <span class="token assign-left variable">REMAINDER</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>TIMESTAMP <span class="token operator">%</span> <span class="token number">3</span><span class="token variable">))</span></span>
  
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$REMAINDER</span> <span class="token parameter variable">-eq</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
        <span class="token builtin class-name">echo</span> <span class="token string">"ğŸ¯ å‘ç°æœ‰åˆ©æ—¶é—´æˆ³! æ‰§è¡ŒPTBæ”»å‡»!"</span>
  
        <span class="token keyword">if</span> execute_ptb_attack <span class="token number">20</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
            <span class="token comment"># è´­ä¹°å®ç®±</span>
            <span class="token assign-left variable">BUY_RESULT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>sui client call <span class="token parameter variable">--package</span> $PACKAGE_ID <span class="token parameter variable">--module</span> adventure <span class="token parameter variable">--function</span> buy_box <span class="token parameter variable">--args</span> $USERS_TOKEN_AMOUNT_ID --gas-budget <span class="token number">20000000</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span><span class="token variable">)</span></span>
  
            <span class="token comment"># æå–å®ç®±IDå¹¶è·å–Flag</span>
            <span class="token assign-left variable">TREASURY_BOX_ID</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$BUY_RESULT</span>"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-A</span> <span class="token number">10</span> <span class="token string">"Created Objects"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"ID:"</span> <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-o</span> <span class="token string">'0x[a-f0-9]\&#123;64\&#125;'</span><span class="token variable">)</span></span>
  
            <span class="token assign-left variable">FLAG_RESULT</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>sui client call <span class="token parameter variable">--package</span> $PACKAGE_ID <span class="token parameter variable">--module</span> inventory <span class="token parameter variable">--function</span> get_flag <span class="token parameter variable">--args</span> $TREASURY_BOX_ID --gas-budget <span class="token number">20000000</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span><span class="token variable">)</span></span>
  
            <span class="token assign-left variable">FLAG_TX_HASH</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$FLAG_RESULT</span>"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">"Transaction Digest:"</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-o</span> <span class="token string">'[A-Za-z0-9]\&#123;44\&#125;'</span><span class="token variable">)</span></span>
            <span class="token builtin class-name">echo</span> <span class="token string">"ğŸ Flagäº¤æ˜“å“ˆå¸Œ: <span class="token variable">$FLAG_TX_HASH</span>"</span>
            <span class="token builtin class-name">exit</span> <span class="token number">0</span>
        <span class="token keyword">fi</span>
    <span class="token keyword">fi</span>
  
    <span class="token comment"># é‡ç½®ä½™é¢å¹¶ç­‰å¾…ä¸‹ä¸€æ¬¡æœºä¼š</span>
    sui client call <span class="token parameter variable">--package</span> <span class="token variable">$PACKAGE_ID</span> <span class="token parameter variable">--module</span> adventure <span class="token parameter variable">--function</span> init_balances <span class="token parameter variable">--args</span> <span class="token variable">$USERS_TOKEN_AMOUNT_ID</span> --gas-budget <span class="token number">10000000</span> <span class="token operator">></span> /dev/null <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span>
    <span class="token function">sleep</span> <span class="token number">1</span>
<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="æ”»å‡»æ‰§è¡Œè¿‡ç¨‹"><a href="#æ”»å‡»æ‰§è¡Œè¿‡ç¨‹" class="headerlink" title="æ”»å‡»æ‰§è¡Œè¿‡ç¨‹"></a>æ”»å‡»æ‰§è¡Œè¿‡ç¨‹</h2><h3 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># éƒ¨ç½²åˆçº¦è·å–Package ID</span>
Package ID: 0x539e759491e4093d8438c03daf03217d2b73920f44eb44e37421583ac2bae05d
Hero ID: 0xbf93ccc1f6776e92e70130b287c60fe7c1938b62490884faf4af17ac8f3bc134
UsersTokenAmount ID: 0xa105e23ff0fd60bff8b216e2b409745ccaa4e29d996f5cc27fffd4aab1fdfe45<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-è‹±é›„å‡çº§"><a href="#2-è‹±é›„å‡çº§" class="headerlink" title="2. è‹±é›„å‡çº§"></a>2. è‹±é›„å‡çº§</h3><ul>
<li>å‡»è´¥30åªæ™®é€šé‡çŒªè·å¾—160ç‚¹ç»éªŒ</li>
<li>å‡çº§è‹±é›„ï¼šstrength 10â†’40, defense 5â†’20, hp 100â†’200</li>
</ul>
<h3 id="3-PTBæ”»å‡»"><a href="#3-PTBæ”»å‡»" class="headerlink" title="3. PTBæ”»å‡»"></a>3. PTBæ”»å‡»</h3><ul>
<li>ç­‰å¾…æ—¶é—´æˆ³ä½™æ•°ä¸º1çš„æœ‰åˆ©æ—¶æœº</li>
<li>æ‰§è¡Œ20æ¬¡æ‰¹é‡ <code>slay_boar_king</code>è°ƒç”¨</li>
<li>æˆåŠŸä»100 tokenå¢åŠ åˆ°200 token</li>
</ul>
<h3 id="4-è·å–Flag"><a href="#4-è·å–Flag" class="headerlink" title="4. è·å–Flag"></a>4. è·å–Flag</h3><ul>
<li>è´­ä¹°å®ç®±ï¼ˆåˆ©ç”¨è®¡è´¹é”™è¯¯ï¼‰</li>
<li>è°ƒç”¨ <code>get_flag</code>è·å–Flagäº‹ä»¶</li>
</ul>
<h2 id="æ”»å‡»ç»“æœ"><a href="#æ”»å‡»ç»“æœ" class="headerlink" title="æ”»å‡»ç»“æœ"></a>æ”»å‡»ç»“æœ</h2><p><strong>æˆåŠŸè·å–Flagäº¤æ˜“å“ˆå¸Œ</strong>: <code>23CBKEHSiwoB1TkJyhQAG1zhuHpWDLpHESdmeWSWs3Gs</code></p>
<h2 id="æŠ€æœ¯è¦ç‚¹æ€»ç»“"><a href="#æŠ€æœ¯è¦ç‚¹æ€»ç»“" class="headerlink" title="æŠ€æœ¯è¦ç‚¹æ€»ç»“"></a>æŠ€æœ¯è¦ç‚¹æ€»ç»“</h2><ol>
<li><strong>æ¼æ´ç»„åˆåˆ©ç”¨</strong>: ä½“åŠ›æ¶ˆè€—æ¼æ´ + æ—¶é—´æˆ³ä¾èµ– + è®¡è´¹é”™è¯¯</li>
<li><strong>PTBæ—¶é—´æˆ³åŒæ­¥</strong>: ç¡®ä¿æ‰¹é‡æ“ä½œä½¿ç”¨ç›¸åŒæ—¶é—´æˆ³</li>
<li><strong>è‹±é›„å‡çº§æœºåˆ¶</strong>: å‘ç°å¹¶åˆ©ç”¨å‡çº§ç³»ç»Ÿæå‡æˆ˜æ–—åŠ›</li>
<li><strong>æ¦‚ç‡æ”»å‡»ä¼˜åŒ–</strong>: ä»1&#x2F;3æˆåŠŸç‡æå‡åˆ°100%æˆåŠŸç‡</li>
</ol>
<h2 id="é˜²å¾¡å»ºè®®"><a href="#é˜²å¾¡å»ºè®®" class="headerlink" title="é˜²å¾¡å»ºè®®"></a>é˜²å¾¡å»ºè®®</h2><ol>
<li><strong>ä¿®å¤ä½“åŠ›æ¶ˆè€—</strong>: å–æ¶ˆæ³¨é‡Š <code>hero::decrease_stamina(hero, 2)</code></li>
<li><strong>ç§»é™¤æ—¶é—´æˆ³ä¾èµ–</strong>: ä½¿ç”¨å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆ</li>
<li><strong>ä¿®å¤è®¡è´¹é”™è¯¯</strong>: ç»Ÿä¸€æ£€æŸ¥å’Œæ‰£é™¤é‡‘é¢</li>
<li><strong>é™åˆ¶æ‰¹é‡æ“ä½œ</strong>: å¯¹PTBä¸­çš„é‡å¤è°ƒç”¨è¿›è¡Œé™åˆ¶</li>
</ol>
<p>è¿™æ¬¡æ”»å‡»å±•ç¤ºäº†æ™ºèƒ½åˆçº¦ä¸­å¤šä¸ªçœ‹ä¼¼æ— å…³çš„å°æ¼æ´å¦‚ä½•è¢«å·§å¦™ç»„åˆï¼Œå½¢æˆå®Œæ•´çš„æ”»å‡»é“¾ã€‚</p>
<h2 id="è¯¦ç»†æŠ€æœ¯åˆ†æ"><a href="#è¯¦ç»†æŠ€æœ¯åˆ†æ" class="headerlink" title="è¯¦ç»†æŠ€æœ¯åˆ†æ"></a>è¯¦ç»†æŠ€æœ¯åˆ†æ</h2><h3 id="æ—¶é—´æˆ³æ”»å‡»åŸç†"><a href="#æ—¶é—´æˆ³æ”»å‡»åŸç†" class="headerlink" title="æ—¶é—´æˆ³æ”»å‡»åŸç†"></a>æ—¶é—´æˆ³æ”»å‡»åŸç†</h3><p>SuiåŒºå—é“¾ä¸­ï¼ŒåŒä¸€ä¸ªPTBå†…çš„æ‰€æœ‰æ“ä½œå…±äº«ç›¸åŒçš„æ—¶é—´æˆ³ã€‚è¿™ä¸ªç‰¹æ€§è¢«ç”¨æ¥ç»•è¿‡éšæœºæ€§ï¼š</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">let</span> current_timestamp <span class="token operator">=</span> <span class="token namespace">clock<span class="token punctuation">::</span></span><span class="token function">timestamp_ms</span><span class="token punctuation">(</span>clock<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> d100 <span class="token operator">=</span> current_timestamp <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>é€šè¿‡åœ¨shellä¸­æ£€æŸ¥æ—¶é—´æˆ³å¹¶åœ¨æœ‰åˆ©æ—¶æœºç«‹å³æ‰§è¡ŒPTBï¼Œå¯ä»¥ç¡®ä¿æ‰€æœ‰20æ¬¡è°ƒç”¨éƒ½è·å¾—å¥–åŠ±ã€‚</p>
<h3 id="PTBæ„é€ æŠ€å·§"><a href="#PTBæ„é€ æŠ€å·§" class="headerlink" title="PTBæ„é€ æŠ€å·§"></a>PTBæ„é€ æŠ€å·§</h3><p>å…³é”®åœ¨äºæ­£ç¡®æ„é€ PTBå‘½ä»¤ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client ptb <span class="token punctuation">\</span>
  --move-call package::module::function <span class="token string">""</span> @arg1 @arg2 @arg3 <span class="token punctuation">\</span>
  --move-call package::module::function <span class="token string">""</span> @arg1 @arg2 @arg3 <span class="token punctuation">\</span>
  <span class="token punctuation">..</span>. <span class="token punctuation">(</span>é‡å¤20æ¬¡<span class="token punctuation">)</span>
  --gas-budget <span class="token number">100000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ¯ä¸ª <code>--move-call</code>ä»£è¡¨ä¸€æ¬¡å‡½æ•°è°ƒç”¨ï¼Œæ‰€æœ‰è°ƒç”¨åœ¨åŒä¸€ä¸ªäº¤æ˜“ä¸­æ‰§è¡Œã€‚</p>
<h3 id="è‹±é›„å‡çº§æ•°å€¼åˆ†æ"><a href="#è‹±é›„å‡çº§æ•°å€¼åˆ†æ" class="headerlink" title="è‹±é›„å‡çº§æ•°å€¼åˆ†æ"></a>è‹±é›„å‡çº§æ•°å€¼åˆ†æ</h3><p>å‡çº§å‰åæˆ˜æ–—åŠ›å¯¹æ¯”ï¼š</p>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>å‡çº§å‰</th>
<th>å‡çº§å</th>
<th>æå‡</th>
</tr>
</thead>
<tbody><tr>
<td>Level</td>
<td>1</td>
<td>2</td>
<td>+1</td>
</tr>
<tr>
<td>Strength</td>
<td>10</td>
<td>40</td>
<td>+30</td>
</tr>
<tr>
<td>Defense</td>
<td>5</td>
<td>20</td>
<td>+15</td>
</tr>
<tr>
<td>HP</td>
<td>100</td>
<td>200</td>
<td>+100</td>
</tr>
</tbody></table>
<p>é‡çŒªç‹å±æ€§èŒƒå›´ï¼š</p>
<ul>
<li>HP: 180-220</li>
<li>Strength: 20-25</li>
<li>Defense: 10-15</li>
</ul>
<p>å‡çº§åè‹±é›„çš„40ç‚¹æ”»å‡»åŠ›å¯ä»¥è½»æ¾çªç ´é‡çŒªç‹çš„10-15é˜²å¾¡ã€‚</p>
<h2 id="æ”»å‡»æ—¶é—´çº¿"><a href="#æ”»å‡»æ—¶é—´çº¿" class="headerlink" title="æ”»å‡»æ—¶é—´çº¿"></a>æ”»å‡»æ—¶é—´çº¿</h2><ol>
<li><strong>00:00</strong> - åˆ†æåˆçº¦ä»£ç ï¼Œå‘ç°å¤šä¸ªæ¼æ´</li>
<li><strong>00:30</strong> - å°è¯•ç›´æ¥æ”»å‡»é‡çŒªç‹ï¼Œå‘ç°æˆ˜æ–—åŠ›ä¸è¶³</li>
<li><strong>01:00</strong> - ç ”ç©¶è‹±é›„å‡çº§æœºåˆ¶</li>
<li><strong>01:30</strong> - å‡»è´¥30åªæ™®é€šé‡çŒªï¼Œå‡çº§è‹±é›„</li>
<li><strong>02:00</strong> - å¼€å‘PTBæ”»å‡»è„šæœ¬</li>
<li><strong>02:30</strong> - æˆåŠŸæ‰§è¡Œæ”»å‡»ï¼Œè·å–Flag</li>
</ol>
<h2 id="å…³é”®ä»£ç ç‰‡æ®µ"><a href="#å…³é”®ä»£ç ç‰‡æ®µ" class="headerlink" title="å…³é”®ä»£ç ç‰‡æ®µ"></a>å…³é”®ä»£ç ç‰‡æ®µ</h2><h3 id="æ¼æ´ä»£ç 1-ä½“åŠ›æ¶ˆè€—è¢«æ³¨é‡Š"><a href="#æ¼æ´ä»£ç 1-ä½“åŠ›æ¶ˆè€—è¢«æ³¨é‡Š" class="headerlink" title="æ¼æ´ä»£ç 1: ä½“åŠ›æ¶ˆè€—è¢«æ³¨é‡Š"></a>æ¼æ´ä»£ç 1: ä½“åŠ›æ¶ˆè€—è¢«æ³¨é‡Š</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">entry fun <span class="token function">slay_boar_king</span><span class="token punctuation">(</span>clock<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token namespace">clock<span class="token punctuation">::</span></span><span class="token class-name">Clock</span><span class="token punctuation">,</span> usersTokenAmount<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">UsersTokenAmount</span><span class="token punctuation">,</span> hero<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">Hero</span><span class="token punctuation">,</span> ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">TxContext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token namespace">tx_context<span class="token punctuation">::</span></span><span class="token function">sender</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token namespace">hero<span class="token punctuation">::</span></span><span class="token function">stamina</span><span class="token punctuation">(</span>hero<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">EHERO_TIRED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// ...</span>
    <span class="token keyword">let</span> fight_result <span class="token operator">=</span> fight_monster<span class="token operator">&lt;</span><span class="token class-name">BoarKing</span><span class="token operator">></span><span class="token punctuation">(</span>hero<span class="token punctuation">,</span> <span class="token operator">&amp;</span>boar<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//hero::decrease_stamina(hero, 2);  // â† å…³é”®æ¼æ´ï¼šè¢«æ³¨é‡Šæ‰</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ¼æ´ä»£ç 2-æ—¶é—´æˆ³ä¾èµ–"><a href="#æ¼æ´ä»£ç 2-æ—¶é—´æˆ³ä¾èµ–" class="headerlink" title="æ¼æ´ä»£ç 2: æ—¶é—´æˆ³ä¾èµ–"></a>æ¼æ´ä»£ç 2: æ—¶é—´æˆ³ä¾èµ–</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">if</span> <span class="token punctuation">(</span>fight_result <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> current_timestamp <span class="token operator">=</span> <span class="token namespace">clock<span class="token punctuation">::</span></span><span class="token function">timestamp_ms</span><span class="token punctuation">(</span>clock<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> d100 <span class="token operator">=</span> current_timestamp <span class="token operator">%</span> <span class="token number">3</span><span class="token punctuation">;</span>  <span class="token comment">// â† å¯é¢„æµ‹çš„"éšæœº"æ•°</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>d100 <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> current_balance <span class="token operator">=</span> <span class="token namespace">table<span class="token punctuation">::</span></span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> usersTokenAmount<span class="token punctuation">.</span>balances<span class="token punctuation">,</span> sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span>current_balance <span class="token operator">=</span> <span class="token operator">*</span>current_balance <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment">// å¥–åŠ±</span>
        <span class="token namespace">event<span class="token punctuation">::</span></span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token class-name">Amount</span><span class="token punctuation">&#123;</span>amount<span class="token punctuation">:</span> <span class="token operator">*</span>current_balance<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">let</span> current_balance <span class="token operator">=</span> <span class="token namespace">table<span class="token punctuation">::</span></span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> usersTokenAmount<span class="token punctuation">.</span>balances<span class="token punctuation">,</span> sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">*</span>current_balance <span class="token operator">=</span> <span class="token operator">*</span>current_balance <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">;</span>  <span class="token comment">// æƒ©ç½š</span>
        <span class="token namespace">event<span class="token punctuation">::</span></span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token class-name">Amount</span><span class="token punctuation">&#123;</span>amount<span class="token punctuation">:</span> <span class="token operator">*</span>current_balance<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ¼æ´ä»£ç 3-è®¡è´¹é”™è¯¯"><a href="#æ¼æ´ä»£ç 3-è®¡è´¹é”™è¯¯" class="headerlink" title="æ¼æ´ä»£ç 3: è®¡è´¹é”™è¯¯"></a>æ¼æ´ä»£ç 3: è®¡è´¹é”™è¯¯</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">public entry fun <span class="token function">buy_box</span><span class="token punctuation">(</span>usersTokenAmount<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">UsersTokenAmount</span><span class="token punctuation">,</span> ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">TxContext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token namespace">tx_context<span class="token punctuation">::</span></span><span class="token function">sender</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> current_balance <span class="token operator">=</span> <span class="token namespace">table<span class="token punctuation">::</span></span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> usersTokenAmount<span class="token punctuation">.</span>balances<span class="token punctuation">,</span> sender<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token namespace">event<span class="token punctuation">::</span></span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token class-name">Amount</span><span class="token punctuation">&#123;</span>amount<span class="token punctuation">:</span> <span class="token operator">*</span>current_balance<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token operator">*</span>current_balance <span class="token operator">>=</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token constant">ERROR_NO_MONEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// â† æ£€æŸ¥200</span>
    <span class="token operator">*</span>current_balance <span class="token operator">=</span> <span class="token operator">*</span>current_balance <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">;</span>         <span class="token comment">// â† ä½†åªæ‰£100</span>
    <span class="token keyword">let</span> <span class="token keyword">box</span> <span class="token operator">=</span> <span class="token namespace">inventory<span class="token punctuation">::</span></span><span class="token function">create_treasury_box</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token namespace">transfer<span class="token punctuation">::</span></span><span class="token function">public_transfer</span><span class="token punctuation">(</span><span class="token keyword">box</span><span class="token punctuation">,</span> <span class="token namespace">tx_context<span class="token punctuation">::</span></span><span class="token function">sender</span><span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å®Œæ•´æ”»å‡»è„šæœ¬"><a href="#å®Œæ•´æ”»å‡»è„šæœ¬" class="headerlink" title="å®Œæ•´æ”»å‡»è„šæœ¬"></a>å®Œæ•´æ”»å‡»è„šæœ¬</h2><p>å°†æ”»å‡»è„šæœ¬ä¿å­˜ä¸º <code>ptb_batch_attack.sh</code> å¹¶æ‰§è¡Œï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> +x ptb_batch_attack.sh
./ptb_batch_attack.sh<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è„šæœ¬ä¼šè‡ªåŠ¨ï¼š</p>
<ol>
<li>ç›‘æ§æ—¶é—´æˆ³ï¼Œç­‰å¾…æœ‰åˆ©æ—¶æœº</li>
<li>æ‰§è¡ŒPTBæ‰¹é‡æ”»å‡»</li>
<li>è´­ä¹°å®ç®±å¹¶è·å–Flag</li>
<li>è¾“å‡ºFlagäº¤æ˜“å“ˆå¸Œ</li>
</ol>
<h2 id="å­¦ä¹ è¦ç‚¹"><a href="#å­¦ä¹ è¦ç‚¹" class="headerlink" title="å­¦ä¹ è¦ç‚¹"></a>å­¦ä¹ è¦ç‚¹</h2><ol>
<li><strong>ä»£ç å®¡è®¡é‡è¦æ€§</strong>: ä»”ç»†æ£€æŸ¥æ¯ä¸€è¡Œä»£ç ï¼ŒåŒ…æ‹¬æ³¨é‡Š</li>
<li><strong>æ¼æ´ç»„åˆå¨åŠ›</strong>: å¤šä¸ªå°æ¼æ´ç»„åˆå¯èƒ½äº§ç”Ÿä¸¥é‡å½±å“</li>
<li><strong>åŒºå—é“¾ç‰¹æ€§åˆ©ç”¨</strong>: ç†è§£PTBç­‰åŒºå—é“¾ç‰¹æœ‰æœºåˆ¶</li>
<li><strong>æ”»å‡»é“¾æ„é€ </strong>: ä»ä¿¡æ¯æ”¶é›†åˆ°æœ€ç»ˆåˆ©ç”¨çš„å®Œæ•´æµç¨‹</li>
</ol>
<h2 id="ç›¸å…³èµ„æº"><a href="#ç›¸å…³èµ„æº" class="headerlink" title="ç›¸å…³èµ„æº"></a>ç›¸å…³èµ„æº</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.sui.io/concepts/sui-move-concepts">Sui Move å®˜æ–¹æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.sui.io/concepts/transactions/prog-txn-blocks">PTB ç¼–ç¨‹æŒ‡å—</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/slowmist/Knowledge-Base/blob/master/translations/move-security-guidelines-zh.md">æ™ºèƒ½åˆçº¦å®‰å…¨æœ€ä½³å®è·µ</a></li>
</ul>
<hr>
<h1 id="2-å¼ºç›—æ¸¸æˆ"><a href="#2-å¼ºç›—æ¸¸æˆ" class="headerlink" title="2. å¼ºç›—æ¸¸æˆ"></a>2. å¼ºç›—æ¸¸æˆ</h1><h2 id="é¢˜ç›®ä¿¡æ¯"><a href="#é¢˜ç›®ä¿¡æ¯" class="headerlink" title="é¢˜ç›®ä¿¡æ¯"></a>é¢˜ç›®ä¿¡æ¯</h2><ul>
<li><strong>é¢˜ç›®åç§°</strong>: å¼ºç›—æ¸¸æˆ</li>
<li><strong>é¢˜ç›®ç§¯åˆ†</strong>: 52</li>
<li><strong>åˆ†ç±»</strong>: blockchain, hohctf, sui, move</li>
<li><strong>è§£é¢˜äººæ•°</strong>: 46</li>
</ul>
<h2 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h2><p>æˆ¿å±‹åŠ æƒçš„å¼ºç›—æ¸¸æˆï¼Œä½ èƒ½æˆåŠŸè·å–ç›®æ ‡é‡‘é¢å—ï¼ŸHOH moveCTF å¼ºç›—æ¸¸æˆ</p>
<p>é¢˜ç›®æä¾›äº†ä¸€ä¸ªç‹¬ç‰¹çš„ Sui Move åˆçº¦ï¼š</p>
<ul>
<li><strong>Package ID</strong>: <code>0x954a8b423d8e7e01a0e2519dcaf6bf0ab9c7d11d845f1762654277ebff45743c</code></li>
<li><strong>éƒ¨ç½²äº¤æ˜“å“ˆå¸Œ</strong>: <code>JB4yrd8L6srxeLv6mAhBo13sYdXqzVyJiXVCSXwQgvxY</code></li>
</ul>
<h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><h3 id="1-åˆçº¦åˆ†æ"><a href="#1-åˆçº¦åˆ†æ" class="headerlink" title="1. åˆçº¦åˆ†æ"></a>1. åˆçº¦åˆ†æ</h3><p>é¦–å…ˆåˆ†æMoveåˆçº¦æºç ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªåŸºäºåŠ¨æ€è§„åˆ’çš„â€æˆ¿å±‹å¼ºç›—â€é—®é¢˜å˜ç§ï¼š</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust">module <span class="token namespace">game<span class="token punctuation">::</span></span>ez_game <span class="token punctuation">&#123;</span>
    public <span class="token keyword">struct</span> <span class="token type-definition class-name">Challenge</span> has key<span class="token punctuation">,</span> store <span class="token punctuation">&#123;</span>
        id<span class="token punctuation">:</span> <span class="token constant">UID</span><span class="token punctuation">,</span>
        initial_part<span class="token punctuation">:</span> vector<span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">></span><span class="token punctuation">,</span>
        weights<span class="token punctuation">:</span> vector<span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">></span><span class="token punctuation">,</span>
        target_amount<span class="token punctuation">:</span> <span class="token keyword">u64</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span>

    public <span class="token keyword">struct</span> <span class="token type-definition class-name">Flag</span> has copy<span class="token punctuation">,</span> drop <span class="token punctuation">&#123;</span>
        owner<span class="token punctuation">:</span> address<span class="token punctuation">,</span>
        flag<span class="token punctuation">:</span> <span class="token keyword">bool</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…³é”®å‡½æ•°ï¼š</p>
<ul>
<li><code>init_game</code>: åˆå§‹åŒ–æ¸¸æˆï¼Œåˆ›å»ºChallengeå¯¹è±¡ï¼Œè®¾ç½®éšæœºç›®æ ‡é‡‘é¢(10-20)</li>
<li><code>get_flag</code>: éªŒè¯ç”¨æˆ·è¾“å…¥ï¼Œå¦‚æœè®¡ç®—ç»“æœç­‰äºç›®æ ‡é‡‘é¢åˆ™è§¦å‘Flagäº‹ä»¶</li>
<li><code>weighted_rob</code>: åŠ æƒæˆ¿å±‹å¼ºç›—ç®—æ³•æ ¸å¿ƒå®ç°</li>
</ul>
<h3 id="2-ç®—æ³•ç†è§£"><a href="#2-ç®—æ³•ç†è§£" class="headerlink" title="2. ç®—æ³•ç†è§£"></a>2. ç®—æ³•ç†è§£</h3><p><code>weighted_rob</code>å‡½æ•°å®ç°äº†ä¸€ä¸ªåŠ¨æ€è§„åˆ’ç®—æ³•ï¼š</p>
<ul>
<li>åˆå§‹æˆ¿å±‹ï¼š<code>[1, 1, 3, 1, 1]</code></li>
<li>åˆå§‹æƒé‡ï¼š<code>[1, 1, 2, 1, 1]</code></li>
<li>ç”¨æˆ·å¯ä»¥æ·»åŠ é¢å¤–æˆ¿å±‹ï¼ˆæƒé‡é»˜è®¤ä¸º1ï¼‰</li>
<li>ä¸èƒ½æŠ¢åŠ«ç›¸é‚»çš„æˆ¿å±‹</li>
<li>æ¯ä¸ªæˆ¿å±‹çš„ä»·å€¼ &#x3D; æˆ¿å±‹å€¼ Ã— æƒé‡</li>
<li>ç›®æ ‡ï¼šæ‰¾åˆ°æœ€å¤§æ”¶ç›Š</li>
</ul>
<h3 id="3-è§£é¢˜è„šæœ¬"><a href="#3-è§£é¢˜è„šæœ¬" class="headerlink" title="3. è§£é¢˜è„šæœ¬"></a>3. è§£é¢˜è„šæœ¬</h3><p>ç¼–å†™Pythonè„šæœ¬åˆ†ææ‰€æœ‰å¯èƒ½çš„ç›®æ ‡é‡‘é¢ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">weighted_rob</span><span class="token punctuation">(</span>houses<span class="token punctuation">,</span> weights<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>houses<span class="token punctuation">)</span>
    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>

    dp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    dp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>houses<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> n <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>
        dp<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>
            houses<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> weights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            houses<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">*</span> weights<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        <span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        dp_i_1 <span class="token operator">=</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
        dp_i_2_plus_house <span class="token operator">=</span> dp<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> houses<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> weights<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        dp<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">max</span><span class="token punctuation">(</span>dp_i_1<span class="token punctuation">,</span> dp_i_2_plus_house<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> dp<span class="token punctuation">[</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é€šè¿‡åˆ†æå‘ç°æ‰€æœ‰ç›®æ ‡é‡‘é¢çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>ç›®æ ‡é‡‘é¢ 10 â†’ ç”¨æˆ·è¾“å…¥: [3]</li>
<li>ç›®æ ‡é‡‘é¢ 11 â†’ ç”¨æˆ·è¾“å…¥: [4]</li>
<li>ç›®æ ‡é‡‘é¢ 12 â†’ ç”¨æˆ·è¾“å…¥: [5]</li>
<li>â€¦</li>
<li>ç›®æ ‡é‡‘é¢ 20 â†’ ç”¨æˆ·è¾“å…¥: [13]</li>
</ul>
<h2 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h2><h3 id="1-åˆå§‹åŒ–æ¸¸æˆ"><a href="#1-åˆå§‹åŒ–æ¸¸æˆ" class="headerlink" title="1. åˆå§‹åŒ–æ¸¸æˆ"></a>1. åˆå§‹åŒ–æ¸¸æˆ</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client call <span class="token parameter variable">--package</span> 0x954a8b423d8e7e01a0e2519dcaf6bf0ab9c7d11d845f1762654277ebff45743c <span class="token punctuation">\</span>
  <span class="token parameter variable">--module</span> ez_game <span class="token parameter variable">--function</span> init_game <span class="token parameter variable">--args</span> 0x8<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>åˆ›å»ºäº†Challengeå¯¹è±¡ï¼š<code>0x4b98169ca6098b972144de03249b0f700e4e2c005c9ed95b88e080475944bd92</code></p>
<h3 id="2-æŸ¥çœ‹Challengeå¯¹è±¡"><a href="#2-æŸ¥çœ‹Challengeå¯¹è±¡" class="headerlink" title="2. æŸ¥çœ‹Challengeå¯¹è±¡"></a>2. æŸ¥çœ‹Challengeå¯¹è±¡</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client object 0x4b98169ca6098b972144de03249b0f700e4e2c005c9ed95b88e080475944bd92<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è·å–åˆ°å…³é”®ä¿¡æ¯ï¼š</p>
<ul>
<li><strong>ç›®æ ‡é‡‘é¢</strong>: 15</li>
<li><strong>åˆå§‹æˆ¿å±‹</strong>: [1, 1, 3, 1, 1]</li>
<li><strong>æƒé‡</strong>: [1, 1, 2, 1, 1]</li>
</ul>
<h3 id="3-è®¡ç®—è§£å†³æ–¹æ¡ˆ"><a href="#3-è®¡ç®—è§£å†³æ–¹æ¡ˆ" class="headerlink" title="3. è®¡ç®—è§£å†³æ–¹æ¡ˆ"></a>3. è®¡ç®—è§£å†³æ–¹æ¡ˆ</h3><p>æ ¹æ®ç›®æ ‡é‡‘é¢15ï¼Œå¯¹åº”çš„ç”¨æˆ·è¾“å…¥æ˜¯ <code>[8]</code>ã€‚</p>
<p>éªŒè¯è®¡ç®—è¿‡ç¨‹ï¼š</p>
<ul>
<li>å®Œæ•´æˆ¿å±‹åˆ—è¡¨ï¼š<code>[1, 1, 3, 1, 1, 8]</code></li>
<li>å®Œæ•´æƒé‡åˆ—è¡¨ï¼š<code>[1, 1, 2, 1, 1, 1]</code></li>
<li>DPè®¡ç®—ï¼š<ul>
<li>dp[0] &#x3D; 1 Ã— 1 &#x3D; 1</li>
<li>dp[1] &#x3D; max(1Ã—1, 1Ã—1) &#x3D; 1</li>
<li>dp[2] &#x3D; max(1, 1 + 3Ã—2) &#x3D; 7</li>
<li>dp[3] &#x3D; max(7, 1 + 1Ã—1) &#x3D; 7</li>
<li>dp[4] &#x3D; max(7, 7 + 1Ã—1) &#x3D; 8</li>
<li>dp[5] &#x3D; max(8, 7 + 8Ã—1) &#x3D; 15 âœ“</li>
</ul>
</li>
</ul>
<h3 id="4-è·å–Flag-1"><a href="#4-è·å–Flag-1" class="headerlink" title="4. è·å–Flag"></a>4. è·å–Flag</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client call <span class="token parameter variable">--package</span> 0x954a8b423d8e7e01a0e2519dcaf6bf0ab9c7d11d845f1762654277ebff45743c <span class="token punctuation">\</span>
  <span class="token parameter variable">--module</span> ez_game <span class="token parameter variable">--function</span> get_flag <span class="token punctuation">\</span>
  <span class="token parameter variable">--args</span> <span class="token string">"[8]"</span> 0x4b98169ca6098b972144de03249b0f700e4e2c005c9ed95b88e080475944bd92<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h2 id="è§£é¢˜ç»“æœ"><a href="#è§£é¢˜ç»“æœ" class="headerlink" title="è§£é¢˜ç»“æœ"></a>è§£é¢˜ç»“æœ</h2><p><strong>æˆåŠŸè§¦å‘Flagäº‹ä»¶ï¼</strong></p>
<p><strong>è§¦å‘Flagçš„äº¤æ˜“å“ˆå¸Œ</strong>: <code>3ZbbGVQkNLxuUACjdnRbLb5YF9NQ5MDuTiogDD3HYwaa</code></p>
<p>äº¤æ˜“äº‹ä»¶ä¸­æ˜¾ç¤ºï¼š</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"flag"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"owner"</span><span class="token operator">:</span> <span class="token string">"0x5284d0a3eb3c5eb84fdd7f27c7e60f486315e99d9f2826b6c35f0e8b0981c6fe"</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="å…³é”®æŠ€æœ¯ç‚¹"><a href="#å…³é”®æŠ€æœ¯ç‚¹" class="headerlink" title="å…³é”®æŠ€æœ¯ç‚¹"></a>å…³é”®æŠ€æœ¯ç‚¹</h2><ol>
<li><strong>Sui Moveåˆçº¦äº¤äº’</strong>: ç†è§£SuiåŒºå—é“¾çš„å¯¹è±¡æ¨¡å‹å’Œäº¤æ˜“æœºåˆ¶</li>
<li><strong>åŠ¨æ€è§„åˆ’ç®—æ³•</strong>: æŒæ¡æˆ¿å±‹å¼ºç›—é—®é¢˜çš„ç»å…¸DPè§£æ³•</li>
<li><strong>åŠ æƒå˜ç§</strong>: ç†è§£æƒé‡å¯¹ç®—æ³•ç»“æœçš„å½±å“</li>
<li><strong>éšæœºæ€§å¤„ç†</strong>: åˆ†ææ‰€æœ‰å¯èƒ½çš„ç›®æ ‡é‡‘é¢å¹¶é¢„è®¡ç®—è§£å†³æ–¹æ¡ˆ</li>
</ol>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™é“é¢˜ç›®å·§å¦™åœ°å°†ç»å…¸çš„åŠ¨æ€è§„åˆ’é—®é¢˜ä¸åŒºå—é“¾æŠ€æœ¯ç»“åˆï¼Œè€ƒæŸ¥äº†ï¼š</p>
<ul>
<li>Moveè¯­è¨€å’ŒSuiåŒºå—é“¾çš„åŸºç¡€çŸ¥è¯†</li>
<li>åŠ¨æ€è§„åˆ’ç®—æ³•çš„ç†è§£å’Œå®ç°</li>
<li>é€†å‘åˆ†æå’Œè§£é¢˜æ€ç»´</li>
</ul>
<hr>
<h1 id="3-æ¢å¤å¯†é’¥"><a href="#3-æ¢å¤å¯†é’¥" class="headerlink" title="3. æ¢å¤å¯†é’¥"></a>3. æ¢å¤å¯†é’¥</h1><h2 id="é¢˜ç›®ä¿¡æ¯-1"><a href="#é¢˜ç›®ä¿¡æ¯-1" class="headerlink" title="é¢˜ç›®ä¿¡æ¯"></a>é¢˜ç›®ä¿¡æ¯</h2><ul>
<li><strong>é¢˜ç›®åç§°</strong>: æ¢å¤ç§é’¥</li>
<li><strong>é¢˜ç›®ç§¯åˆ†</strong>: 63</li>
<li><strong>åˆ†ç±»</strong>: blockchain, hohctf, sui, move</li>
<li><strong>è§£é¢˜äººæ•°</strong>: 32</li>
<li><strong>é¢˜ç›®æè¿°</strong>: æˆ‘åœ¨é“¾ä¸Šç”¨éšæœºæ•°éšè—äº†æˆ‘çš„ç§é’¥ï¼Œä½†æ˜¯æˆ‘å¿˜è®°æˆ‘ç§é’¥çš„å†…å®¹äº†ï¼Œä½ èƒ½å¸®æˆ‘æ¢å¤ç§é’¥å˜›ï¼Ÿ</li>
</ul>
<h2 id="é¢˜ç›®ç¯å¢ƒ"><a href="#é¢˜ç›®ç¯å¢ƒ" class="headerlink" title="é¢˜ç›®ç¯å¢ƒ"></a>é¢˜ç›®ç¯å¢ƒ</h2><ul>
<li><strong>Package ID</strong>: <code>0xd1861626bde7486744877f9ac90ac025976bab6617384cd3e6816e833dd94be9</code></li>
<li><strong>éƒ¨ç½²äº¤æ˜“å“ˆå¸Œ</strong>: <code>Go2jkNk5tR1EnCNV2Fw2zaP6zQfQRPfUeEFyyi6rtJiR</code></li>
</ul>
<h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><h3 id="1-é¢˜ç›®åˆ†æ"><a href="#1-é¢˜ç›®åˆ†æ" class="headerlink" title="1. é¢˜ç›®åˆ†æ"></a>1. é¢˜ç›®åˆ†æ</h3><p>è¿™æ˜¯ä¸€é“ç»“åˆäº†å¯†ç å­¦å’ŒåŒºå—é“¾æŠ€æœ¯çš„ç»¼åˆæ€§CTFé¢˜ç›®ã€‚é€šè¿‡åˆ†ææä¾›çš„Moveæ™ºèƒ½åˆçº¦æºç ï¼Œå¯ä»¥å‘ç°ï¼š</p>
<ol>
<li>é¢˜ç›®ä½¿ç”¨çº¿æ€§ä»£æ•°åŠ å¯†æ–¹æ¡ˆéšè—flag</li>
<li>åŠ å¯†å…¬å¼ï¼š<code>enc = A * flag + k</code><ul>
<li><code>A</code>: 64x23çš„å›ºå®šçŸ©é˜µ</li>
<li><code>flag</code>: 23å­—èŠ‚çš„æ˜æ–‡ï¼ˆå³æˆ‘ä»¬è¦æ¢å¤çš„ç§é’¥ï¼‰</li>
<li><code>k</code>: 64ç»´éšæœºå‘é‡</li>
<li><code>enc</code>: 64ç»´å¯†æ–‡å‘é‡</li>
</ul>
</li>
</ol>
<h3 id="2-å…³é”®ä»£ç åˆ†æ"><a href="#2-å…³é”®ä»£ç åˆ†æ" class="headerlink" title="2. å…³é”®ä»£ç åˆ†æ"></a>2. å…³é”®ä»£ç åˆ†æ</h3><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token comment">// åŠ å¯†å‡½æ•°</span>
entry fun <span class="token function">entrypt_flag</span><span class="token punctuation">(</span>plain_flag<span class="token punctuation">:</span> vector<span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">></span><span class="token punctuation">,</span> r<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token class-name">Random</span><span class="token punctuation">,</span> ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">TxContext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token function">get_a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// è·å–64x23çŸ©é˜µ</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> k<span class="token punctuation">:</span> vector<span class="token operator">&lt;</span><span class="token keyword">u64</span><span class="token operator">></span> <span class="token operator">=</span> vector<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// ç”Ÿæˆ64ä¸ªéšæœºæ•°ä½œä¸ºå™ªå£°</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        k<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token namespace">random<span class="token punctuation">::</span></span><span class="token function">generate_u64_in_range</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> generator<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4294967296</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
    <span class="token comment">// æ‰§è¡ŒåŠ å¯†: enc = A * flag + k</span>
    <span class="token keyword">let</span> enc <span class="token operator">=</span> <span class="token function">matadd</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token function">matmul</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>a<span class="token punctuation">,</span> <span class="token operator">&amp;</span>ex_plain_flag<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// éªŒè¯å‡½æ•°</span>
public entry fun <span class="token function">decrypt_flag</span><span class="token punctuation">(</span>flag<span class="token punctuation">:</span> vector<span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">></span><span class="token punctuation">,</span> ctx<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> <span class="token class-name">TxContext</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token macro property">assert!</span><span class="token punctuation">(</span><span class="token function">blake2b256</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>flag<span class="token punctuation">)</span> <span class="token operator">==</span> x<span class="token string">"5c9d8d1c17561e80b1e29b4a7809b369eb94e3d8b6808c19c69e25f94f67817a"</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token namespace">event<span class="token punctuation">::</span></span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token class-name">FlagEvent</span> <span class="token punctuation">&#123;</span>
        owner<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        flag<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="3-å¯†ç å­¦åŸç†"><a href="#3-å¯†ç å­¦åŸç†" class="headerlink" title="3. å¯†ç å­¦åŸç†"></a>3. å¯†ç å­¦åŸç†</h3><p>è¿™æ˜¯ä¸€ä¸ªåŸºäºæ ¼ç†è®ºçš„åŠ å¯†æ–¹æ¡ˆï¼Œç±»ä¼¼äºLearning With Errors (LWE) é—®é¢˜ã€‚è¦è§£å¯†éœ€è¦è§£å†³æœ€è¿‘å‘é‡é—®é¢˜ï¼ˆCVP - Closest Vector Problemï¼‰ã€‚</p>
<h2 id="è§£é¢˜æ­¥éª¤-1"><a href="#è§£é¢˜æ­¥éª¤-1" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h2><h3 id="æ­¥éª¤1-ç¯å¢ƒå‡†å¤‡"><a href="#æ­¥éª¤1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡"></a>æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡</h3><p>é¦–å…ˆå®‰è£…SageMathæ•°å­¦è®¡ç®—è½¯ä»¶ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> <span class="token parameter variable">-y</span> sagemath<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="æ­¥éª¤2-åˆ†æå¯†æ–‡"><a href="#æ­¥éª¤2-åˆ†æå¯†æ–‡" class="headerlink" title="æ­¥éª¤2: åˆ†æå¯†æ–‡"></a>æ­¥éª¤2: åˆ†æå¯†æ–‡</h3><p>ä»åˆçº¦æºç ä¸­å¯ä»¥çœ‹åˆ°åŠ å¯†åçš„å¯†æ–‡ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">[13244763658160674624, 16984722715248776010, 13823152552092075312, ...]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="æ­¥éª¤3-ä½¿ç”¨CVPç®—æ³•è§£å¯†"><a href="#æ­¥éª¤3-ä½¿ç”¨CVPç®—æ³•è§£å¯†" class="headerlink" title="æ­¥éª¤3: ä½¿ç”¨CVPç®—æ³•è§£å¯†"></a>æ­¥éª¤3: ä½¿ç”¨CVPç®—æ³•è§£å¯†</h3><p>é¢˜ç›®æä¾›äº†è§£å¯†è„šæœ¬ <code>decrypt.sage</code>ï¼Œæ ¸å¿ƒç®—æ³•æ˜¯Babai CVPç®—æ³•ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">Babai_CVP</span><span class="token punctuation">(</span>Lattice<span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">:</span>
    M <span class="token operator">=</span> Lattice<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>
    G <span class="token operator">=</span> M<span class="token punctuation">.</span>gram_schmidt<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    diff <span class="token operator">=</span> target
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>M<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        diff <span class="token operator">-=</span>  M<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>diff <span class="token operator">*</span> G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>G<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">*</span> G<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">round</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> target <span class="token operator">-</span> diff<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ­¥éª¤4-è¿è¡Œè§£å¯†è„šæœ¬"><a href="#æ­¥éª¤4-è¿è¡Œè§£å¯†è„šæœ¬" class="headerlink" title="æ­¥éª¤4: è¿è¡Œè§£å¯†è„šæœ¬"></a>æ­¥éª¤4: è¿è¡Œè§£å¯†è„šæœ¬</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> solve/tests
sage decrypt.sage<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>è¾“å‡ºç»“æœï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">[-]the flag length is: 23
(102, 108, 97, 103, 123, 53, 85, 105, 95, 77, 48, 86, 101, 95, 67, 79, 78, 116, 114, 65, 67, 55, 125)
[+]flag&#123;5Ui_M0Ve_CONtrAC7&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="æ­¥éª¤5-éªŒè¯flag"><a href="#æ­¥éª¤5-éªŒè¯flag" class="headerlink" title="æ­¥éª¤5: éªŒè¯flag"></a>æ­¥éª¤5: éªŒè¯flag</h3><p>ä½¿ç”¨Sui CLIè°ƒç”¨é“¾ä¸Šåˆçº¦éªŒè¯flagï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client call <span class="token punctuation">\</span>
  <span class="token parameter variable">--package</span> 0xd1861626bde7486744877f9ac90ac025976bab6617384cd3e6816e833dd94be9 <span class="token punctuation">\</span>
  <span class="token parameter variable">--module</span> crypto <span class="token punctuation">\</span>
  <span class="token parameter variable">--function</span> decrypt_flag <span class="token punctuation">\</span>
  <span class="token parameter variable">--args</span> <span class="token string">"flag&#123;5Ui_M0Ve_CONtrAC7&#125;"</span> <span class="token punctuation">\</span>
  --gas-budget <span class="token number">10000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="è§£é¢˜ç»“æœ-1"><a href="#è§£é¢˜ç»“æœ-1" class="headerlink" title="è§£é¢˜ç»“æœ"></a>è§£é¢˜ç»“æœ</h2><ul>
<li><strong>Flag</strong>: <code>flag&#123;5Ui_M0Ve_CONtrAC7&#125;</code></li>
<li><strong>äº¤æ˜“å“ˆå¸Œ</strong>: <code>2FPqgAyMe2e7qB5xigrwi35oTqrmwmuC45pCudHLdtVX</code></li>
<li><strong>éªŒè¯çŠ¶æ€</strong>: Successï¼ŒæˆåŠŸè§¦å‘FlagEvent</li>
</ul>
<h2 id="æŠ€æœ¯è¦ç‚¹"><a href="#æŠ€æœ¯è¦ç‚¹" class="headerlink" title="æŠ€æœ¯è¦ç‚¹"></a>æŠ€æœ¯è¦ç‚¹</h2><h3 id="1-æ ¼ç†è®ºåŸºç¡€"><a href="#1-æ ¼ç†è®ºåŸºç¡€" class="headerlink" title="1. æ ¼ç†è®ºåŸºç¡€"></a>1. æ ¼ç†è®ºåŸºç¡€</h3><ul>
<li><strong>æ ¼ (Lattice)</strong>: ç”±åŸºå‘é‡å¼ æˆçš„ç¦»æ•£ç‚¹é›†</li>
<li><strong>CVPé—®é¢˜</strong>: ç»™å®šæ ¼å’Œç›®æ ‡å‘é‡ï¼Œæ‰¾åˆ°æ ¼ä¸­æœ€æ¥è¿‘ç›®æ ‡çš„å‘é‡</li>
<li><strong>LLLç®—æ³•</strong>: æ ¼åŸºçº¦åŒ–ç®—æ³•ï¼Œç”¨äºæ‰¾åˆ°è¾ƒçŸ­çš„åŸºå‘é‡</li>
</ul>
<h3 id="2-Babaiç®—æ³•"><a href="#2-Babaiç®—æ³•" class="headerlink" title="2. Babaiç®—æ³•"></a>2. Babaiç®—æ³•</h3><p>Babaiç®—æ³•æ˜¯è§£å†³CVPé—®é¢˜çš„è¿‘ä¼¼ç®—æ³•ï¼š</p>
<ol>
<li>å¯¹æ ¼åŸºè¿›è¡ŒLLLçº¦åŒ–</li>
<li>ä½¿ç”¨Gram-Schmidtæ­£äº¤åŒ–</li>
<li>é€šè¿‡èˆå…¥æ“ä½œæ‰¾åˆ°æœ€è¿‘å‘é‡</li>
</ol>
<h3 id="3-Moveæ™ºèƒ½åˆçº¦"><a href="#3-Moveæ™ºèƒ½åˆçº¦" class="headerlink" title="3. Moveæ™ºèƒ½åˆçº¦"></a>3. Moveæ™ºèƒ½åˆçº¦</h3><ul>
<li>ä½¿ç”¨SuiåŒºå—é“¾çš„Moveè¯­è¨€</li>
<li>é›†æˆéšæœºæ•°ç”Ÿæˆå™¨è¿›è¡ŒåŠ å¯†</li>
<li>é€šè¿‡äº‹ä»¶æœºåˆ¶éªŒè¯è§£é¢˜ç»“æœ</li>
</ul>
<h2 id="æ€»ç»“-1"><a href="#æ€»ç»“-1" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™é“é¢˜ç›®å·§å¦™åœ°ç»“åˆäº†ï¼š</p>
<ul>
<li><strong>å¯†ç å­¦</strong>: åŸºäºæ ¼ç†è®ºçš„åŠ å¯†æ–¹æ¡ˆ</li>
<li><strong>æ•°å­¦</strong>: çº¿æ€§ä»£æ•°å’Œæœ€è¿‘å‘é‡é—®é¢˜</li>
<li><strong>åŒºå—é“¾</strong>: Sui Moveæ™ºèƒ½åˆçº¦æŠ€æœ¯</li>
</ul>
<p>è§£é¢˜çš„å…³é”®åœ¨äºç†è§£LWEç±»å‹çš„åŠ å¯†æ–¹æ¡ˆï¼Œå¹¶ä½¿ç”¨é€‚å½“çš„æ ¼ç†è®ºç®—æ³•ï¼ˆCVPï¼‰æ¥æ¢å¤æ˜æ–‡ã€‚</p>
<hr>
<h1 id="4-è¿·å®«æ¸¸æˆ"><a href="#4-è¿·å®«æ¸¸æˆ" class="headerlink" title="4. è¿·å®«æ¸¸æˆ"></a>4. è¿·å®«æ¸¸æˆ</h1><h2 id="é¢˜ç›®ä¿¡æ¯-2"><a href="#é¢˜ç›®ä¿¡æ¯-2" class="headerlink" title="é¢˜ç›®ä¿¡æ¯"></a>é¢˜ç›®ä¿¡æ¯</h2><ul>
<li><strong>é¢˜ç›®åç§°</strong>: è¿·å®«æ¸¸æˆ</li>
<li><strong>é¢˜ç›®æè¿°</strong>: è¿™æ˜¯ä¸€é“ctfé¢˜ç›® è¿™é‡Œæœ‰ä¸€ä¸ªè¿·å®«æ¸¸æˆï¼Œä½ èƒ½é¡ºåˆ©èµ°å‡ºè¿™ä¸ªè¿·å®«å—</li>
<li><strong>Package ID</strong>: <code>0x7ed7168ddd553e568e21ccbf4696120e2e476094fb107dbdce81f5be4f4e6d20</code></li>
<li><strong>éƒ¨ç½²äº¤æ˜“å“ˆå¸Œ</strong>: <code>AgCw1ZGx5GFHFJHFTgdqjaVqY2zLrMbSgtevJz29K6yz</code></li>
<li><strong>åŒºå—é“¾</strong>: Sui Network</li>
<li><strong>è¯­è¨€</strong>: Move</li>
</ul>
<h2 id="é¢˜ç›®åˆ†æ"><a href="#é¢˜ç›®åˆ†æ" class="headerlink" title="é¢˜ç›®åˆ†æ"></a>é¢˜ç›®åˆ†æ</h2><h3 id="1-åˆçº¦ç»“æ„åˆ†æ"><a href="#1-åˆçº¦ç»“æ„åˆ†æ" class="headerlink" title="1. åˆçº¦ç»“æ„åˆ†æ"></a>1. åˆçº¦ç»“æ„åˆ†æ</h3><p>é€šè¿‡æŸ¥çœ‹Moveåˆçº¦æºç ï¼Œå‘ç°è¿™æ˜¯ä¸€ä¸ªåŸºäºSuiåŒºå—é“¾çš„è¿·å®«æ¸¸æˆï¼š</p>
<pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token keyword">const</span> <span class="token constant">ROW</span><span class="token punctuation">:</span> <span class="token keyword">u64</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">COL</span><span class="token punctuation">:</span> <span class="token keyword">u64</span> <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">MAZE</span><span class="token punctuation">:</span> vector<span class="token operator">&lt;</span><span class="token keyword">u8</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token string">b"#S########\n#**#######\n##*#######\n##***#####\n####*#####\n##***###E#\n##*#####*#\n##*#####*#\n##*******#\n##########"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">START_POS</span><span class="token punctuation">:</span> <span class="token keyword">u64</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="2-è¿·å®«å¸ƒå±€"><a href="#2-è¿·å®«å¸ƒå±€" class="headerlink" title="2. è¿·å®«å¸ƒå±€"></a>2. è¿·å®«å¸ƒå±€</h3><p>è¿·å®«æ˜¯ä¸€ä¸ª10è¡Œ11åˆ—çš„ç½‘æ ¼ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">#S########
#**#######
##*#######
##***#####
####*#####
##***###E#
##*#####*#
##*#####*#
##*******#
##########<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>#</code>: å¢™å£</li>
<li><code>S</code>: èµ·ç‚¹ (ä½ç½®1)</li>
<li><code>E</code>: ç»ˆç‚¹ (ä½ç½®63)</li>
<li><code>*</code>: å¯é€šè¡Œè·¯å¾„</li>
</ul>
<h3 id="3-æ¸¸æˆæœºåˆ¶"><a href="#3-æ¸¸æˆæœºåˆ¶" class="headerlink" title="3. æ¸¸æˆæœºåˆ¶"></a>3. æ¸¸æˆæœºåˆ¶</h3><p>åˆçº¦æä¾›ä¸‰ä¸ªä¸»è¦å‡½æ•°ï¼š</p>
<ol>
<li><strong>create_challenge()</strong>: åˆ›å»ºæŒ‘æˆ˜ï¼Œç”ŸæˆChallengeStatuså¯¹è±¡</li>
<li><strong>complete_challenge()</strong>: å®Œæˆè¿·å®«ï¼Œéœ€è¦æä¾›æ­£ç¡®çš„ç§»åŠ¨åºåˆ—</li>
<li><strong>claim_flag()</strong>: è·å–flagï¼Œéœ€è¦æŒ‘æˆ˜å®Œæˆåè°ƒç”¨</li>
</ol>
<p>ç§»åŠ¨æ§åˆ¶ï¼š</p>
<ul>
<li><code>w</code> (ASCII 119): å‘ä¸Šç§»åŠ¨</li>
<li><code>s</code> (ASCII 115): å‘ä¸‹ç§»åŠ¨</li>
<li><code>a</code> (ASCII 97): å‘å·¦ç§»åŠ¨</li>
<li><code>d</code> (ASCII 100): å‘å³ç§»åŠ¨</li>
</ul>
<h2 id="è§£é¢˜è¿‡ç¨‹"><a href="#è§£é¢˜è¿‡ç¨‹" class="headerlink" title="è§£é¢˜è¿‡ç¨‹"></a>è§£é¢˜è¿‡ç¨‹</h2><h3 id="æ­¥éª¤1-è¿·å®«è·¯å¾„åˆ†æ"><a href="#æ­¥éª¤1-è¿·å®«è·¯å¾„åˆ†æ" class="headerlink" title="æ­¥éª¤1: è¿·å®«è·¯å¾„åˆ†æ"></a>æ­¥éª¤1: è¿·å®«è·¯å¾„åˆ†æ</h3><p>ä½¿ç”¨BFSç®—æ³•åˆ†æè¿·å®«ï¼Œæ‰¾åˆ°ä»èµ·ç‚¹Såˆ°ç»ˆç‚¹Eçš„æœ€çŸ­è·¯å¾„ã€‚</p>
<p>ä½ç½®ç¼–å·ç³»ç»Ÿï¼š</p>
<ul>
<li>ä½ç½® &#x3D; è¡Œ Ã— 11 + åˆ—</li>
<li>èµ·ç‚¹Såœ¨ä½ç½®1 (ç¬¬0è¡Œç¬¬1åˆ—)</li>
<li>ç»ˆç‚¹Eåœ¨ä½ç½®63 (ç¬¬5è¡Œç¬¬8åˆ—)</li>
</ul>
<h3 id="æ­¥éª¤2-è·¯å¾„æœç´¢ç®—æ³•"><a href="#æ­¥éª¤2-è·¯å¾„æœç´¢ç®—æ³•" class="headerlink" title="æ­¥éª¤2: è·¯å¾„æœç´¢ç®—æ³•"></a>æ­¥éª¤2: è·¯å¾„æœç´¢ç®—æ³•</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">find_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">from</span> collections <span class="token keyword">import</span> deque

    start_pos <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># Sçš„ä½ç½®</span>
    end_pos <span class="token operator">=</span> <span class="token number">63</span>   <span class="token comment"># Eçš„ä½ç½®</span>

    queue <span class="token operator">=</span> deque<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span>start_pos<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    visited <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>start_pos<span class="token punctuation">]</span><span class="token punctuation">)</span>

    <span class="token keyword">while</span> queue<span class="token punctuation">:</span>
        current_pos<span class="token punctuation">,</span> path <span class="token operator">=</span> queue<span class="token punctuation">.</span>popleft<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> current_pos <span class="token operator">==</span> end_pos<span class="token punctuation">:</span>
            <span class="token keyword">return</span> path

        <span class="token comment"># å°è¯•å››ä¸ªæ–¹å‘çš„ç§»åŠ¨</span>
        moves <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">(</span><span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸Š</span>
            <span class="token punctuation">(</span><span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment"># ä¸‹</span>
            <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token comment"># å·¦</span>
            <span class="token punctuation">(</span><span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>     <span class="token comment"># å³</span>
        <span class="token punctuation">]</span>

        <span class="token keyword">for</span> move_char<span class="token punctuation">,</span> delta <span class="token keyword">in</span> moves<span class="token punctuation">:</span>
            new_pos <span class="token operator">=</span> current_pos <span class="token operator">+</span> delta
            <span class="token comment"># è¾¹ç•Œæ£€æŸ¥å’Œå¢™å£æ£€æŸ¥</span>
            <span class="token comment"># ...</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ­¥éª¤3-æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ"><a href="#æ­¥éª¤3-æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ" class="headerlink" title="æ­¥éª¤3: æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ"></a>æ­¥éª¤3: æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ</h3><p>é€šè¿‡BFSæœç´¢ï¼Œæ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼š<strong><code>sdssddssaasssddddddwww</code></strong></p>
<p>è·¯å¾„éªŒè¯ï¼š</p>
<ol>
<li>S(1) â†’ s â†’ 12(<em>) â†’ d â†’ 13(</em>) â†’ s â†’ 24(<em>) â†’ s â†’ 35(</em>)</li>
<li>35(<em>) â†’ d â†’ 36(</em>) â†’ d â†’ 37(<em>) â†’ s â†’ 48(</em>) â†’ s â†’ 59(*)</li>
<li>59(<em>) â†’ a â†’ 58(</em>) â†’ a â†’ 57(<em>) â†’ s â†’ 68(</em>) â†’ s â†’ 79(*)</li>
<li>79(<em>) â†’ s â†’ 90(</em>) â†’ d â†’ 91(<em>) â†’ d â†’ 92(</em>) â†’ d â†’ 93(*)</li>
<li>93(<em>) â†’ d â†’ 94(</em>) â†’ d â†’ 95(<em>) â†’ d â†’ 96(</em>) â†’ w â†’ 85(*)</li>
<li>85(<em>) â†’ w â†’ 74(</em>) â†’ w â†’ 63(E) âœ…</li>
</ol>
<h2 id="é“¾ä¸Šæ‰§è¡Œ"><a href="#é“¾ä¸Šæ‰§è¡Œ" class="headerlink" title="é“¾ä¸Šæ‰§è¡Œ"></a>é“¾ä¸Šæ‰§è¡Œ</h2><h3 id="æ­¥éª¤1-åˆ›å»ºæŒ‘æˆ˜"><a href="#æ­¥éª¤1-åˆ›å»ºæŒ‘æˆ˜" class="headerlink" title="æ­¥éª¤1: åˆ›å»ºæŒ‘æˆ˜"></a>æ­¥éª¤1: åˆ›å»ºæŒ‘æˆ˜</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client call <span class="token punctuation">\</span>
  <span class="token parameter variable">--package</span> 0x7ed7168ddd553e568e21ccbf4696120e2e476094fb107dbdce81f5be4f4e6d20 <span class="token punctuation">\</span>
  <span class="token parameter variable">--module</span> maze <span class="token punctuation">\</span>
  <span class="token parameter variable">--function</span> create_challenge <span class="token punctuation">\</span>
  --gas-budget <span class="token number">10000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»“æœ</strong>:</p>
<ul>
<li>Transaction Digest: <code>BUYeRta41EpQuNTFC41Rj1HYP3m1kfXSGffqgiNGCE5Z</code></li>
<li>Challenge Object ID: <code>0x5c73ad1a8d078a6af83fe3226c09da2984c4af9b61e3da913bafa46091b0ec55</code></li>
</ul>
<h3 id="æ­¥éª¤2-å®Œæˆè¿·å®«æŒ‘æˆ˜"><a href="#æ­¥éª¤2-å®Œæˆè¿·å®«æŒ‘æˆ˜" class="headerlink" title="æ­¥éª¤2: å®Œæˆè¿·å®«æŒ‘æˆ˜"></a>æ­¥éª¤2: å®Œæˆè¿·å®«æŒ‘æˆ˜</h3><p>å°†è·¯å¾„å­—ç¬¦ä¸²è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼š</p>
<ul>
<li><code>sdssddssaasssddddddwww</code> â†’ <code>[115,100,115,115,100,100,115,115,97,97,115,115,115,100,100,100,100,100,100,119,119,119]</code></li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client call <span class="token punctuation">\</span>
  <span class="token parameter variable">--package</span> 0x7ed7168ddd553e568e21ccbf4696120e2e476094fb107dbdce81f5be4f4e6d20 <span class="token punctuation">\</span>
  <span class="token parameter variable">--module</span> maze <span class="token punctuation">\</span>
  <span class="token parameter variable">--function</span> complete_challenge <span class="token punctuation">\</span>
  <span class="token parameter variable">--args</span> 0x5c73ad1a8d078a6af83fe3226c09da2984c4af9b61e3da913bafa46091b0ec55 <span class="token string">'[115,100,115,115,100,100,115,115,97,97,115,115,115,100,100,100,100,100,100,119,119,119]'</span> <span class="token punctuation">\</span>
  --gas-budget <span class="token number">10000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»“æœ</strong>:</p>
<ul>
<li>Transaction Digest: <code>FfbrP2KJemjqbmHJLpCQtthNTnEz7Fs1H6Emop4amqtx</code></li>
<li>è§¦å‘Successäº‹ä»¶ï¼Œè·¯å¾„éªŒè¯æˆåŠŸ</li>
</ul>
<h3 id="æ­¥éª¤3-è·å–Flag"><a href="#æ­¥éª¤3-è·å–Flag" class="headerlink" title="æ­¥éª¤3: è·å–Flag"></a>æ­¥éª¤3: è·å–Flag</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">sui client call <span class="token punctuation">\</span>
  <span class="token parameter variable">--package</span> 0x7ed7168ddd553e568e21ccbf4696120e2e476094fb107dbdce81f5be4f4e6d20 <span class="token punctuation">\</span>
  <span class="token parameter variable">--module</span> maze <span class="token punctuation">\</span>
  <span class="token parameter variable">--function</span> claim_flag <span class="token punctuation">\</span>
  <span class="token parameter variable">--args</span> 0x5c73ad1a8d078a6af83fe3226c09da2984c4af9b61e3da913bafa46091b0ec55 <span class="token punctuation">\</span>
  --gas-budget <span class="token number">10000000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»“æœ</strong>:</p>
<ul>
<li><strong>Transaction Digest</strong>: <code>6AxnhJMhpTbsggtZj52PqGUKMU1sx69Q3zvr9WzdYzwQ</code></li>
<li>è§¦å‘FlagEventäº‹ä»¶ï¼Œsuccess: true</li>
</ul>
<h2 id="å…³é”®æŠ€æœ¯ç‚¹-1"><a href="#å…³é”®æŠ€æœ¯ç‚¹-1" class="headerlink" title="å…³é”®æŠ€æœ¯ç‚¹"></a>å…³é”®æŠ€æœ¯ç‚¹</h2><h3 id="1-Moveåˆçº¦åˆ†æ"><a href="#1-Moveåˆçº¦åˆ†æ" class="headerlink" title="1. Moveåˆçº¦åˆ†æ"></a>1. Moveåˆçº¦åˆ†æ</h3><ul>
<li>ç†è§£Sui Moveè¯­æ³•å’Œç»“æ„</li>
<li>åˆ†æentryå‡½æ•°çš„å‚æ•°è¦æ±‚</li>
<li>ç†è§£äº‹ä»¶æœºåˆ¶</li>
</ul>
<h3 id="2-ç®—æ³•åº”ç”¨"><a href="#2-ç®—æ³•åº”ç”¨" class="headerlink" title="2. ç®—æ³•åº”ç”¨"></a>2. ç®—æ³•åº”ç”¨</h3><ul>
<li>BFSæœ€çŸ­è·¯å¾„æœç´¢</li>
<li>äºŒç»´ç½‘æ ¼åæ ‡è½¬æ¢</li>
<li>è¾¹ç•Œæ¡ä»¶å¤„ç†</li>
</ul>
<h3 id="3-åŒºå—é“¾äº¤äº’"><a href="#3-åŒºå—é“¾äº¤äº’" class="headerlink" title="3. åŒºå—é“¾äº¤äº’"></a>3. åŒºå—é“¾äº¤äº’</h3><ul>
<li>Sui CLIå·¥å…·ä½¿ç”¨</li>
<li>äº¤æ˜“å‚æ•°æ ¼å¼åŒ–</li>
<li>å¯¹è±¡IDç®¡ç†</li>
</ul>
<h3 id="4-æ•°æ®è½¬æ¢"><a href="#4-æ•°æ®è½¬æ¢" class="headerlink" title="4. æ•°æ®è½¬æ¢"></a>4. æ•°æ®è½¬æ¢</h3><ul>
<li>å­—ç¬¦ä¸²åˆ°å­—èŠ‚æ•°ç»„è½¬æ¢</li>
<li>ASCIIç æ˜ å°„</li>
<li>Moveç±»å‹ç³»ç»Ÿç†è§£</li>
</ul>
<h2 id="æ€»ç»“-2"><a href="#æ€»ç»“-2" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è¿™é“é¢˜ç›®è€ƒæŸ¥äº†ï¼š</p>
<ol>
<li><strong>Moveæ™ºèƒ½åˆçº¦åˆ†æèƒ½åŠ›</strong></li>
<li><strong>å›¾è®ºç®—æ³•åº”ç”¨</strong> (BFSè·¯å¾„æœç´¢)</li>
<li><strong>åŒºå—é“¾å·¥å…·ä½¿ç”¨</strong> (Sui CLI)</li>
<li><strong>æ•°æ®æ ¼å¼è½¬æ¢</strong> (å­—ç¬¦ä¸²â†’å­—èŠ‚æ•°ç»„)</li>
</ol>
<p><strong>æœ€ç»ˆç­”æ¡ˆ</strong>: <code>6AxnhJMhpTbsggtZj52PqGUKMU1sx69Q3zvr9WzdYzwQ</code></p>
<p><strong>Flag</strong>: <code>CTF&#123;Letsmovectf&#125;</code></p>
<h2 id="å·¥å…·å’Œè„šæœ¬"><a href="#å·¥å…·å’Œè„šæœ¬" class="headerlink" title="å·¥å…·å’Œè„šæœ¬"></a>å·¥å…·å’Œè„šæœ¬</h2><p>è§£é¢˜è¿‡ç¨‹ä¸­ä½¿ç”¨çš„Pythonè„šæœ¬å¯ä»¥å¸®åŠ©ï¼š</p>
<ul>
<li>è¿·å®«å¯è§†åŒ–å’Œè·¯å¾„æœç´¢</li>
<li>å­—èŠ‚æ•°ç»„æ ¼å¼è½¬æ¢</li>
<li>è‡ªåŠ¨åŒ–åŒºå—é“¾äº¤äº’</li>
</ul>
<hr>
<h1 id="ç»¼åˆæŠ€æœ¯æ€»ç»“"><a href="#ç»¼åˆæŠ€æœ¯æ€»ç»“" class="headerlink" title="ç»¼åˆæŠ€æœ¯æ€»ç»“"></a>ç»¼åˆæŠ€æœ¯æ€»ç»“</h1><h2 id="æ ¸å¿ƒæŠ€èƒ½çŸ©é˜µ"><a href="#æ ¸å¿ƒæŠ€èƒ½çŸ©é˜µ" class="headerlink" title="æ ¸å¿ƒæŠ€èƒ½çŸ©é˜µ"></a>æ ¸å¿ƒæŠ€èƒ½çŸ©é˜µ</h2><h3 id="1-Moveæ™ºèƒ½åˆçº¦åˆ†æ"><a href="#1-Moveæ™ºèƒ½åˆçº¦åˆ†æ" class="headerlink" title="1. Moveæ™ºèƒ½åˆçº¦åˆ†æ"></a>1. Moveæ™ºèƒ½åˆçº¦åˆ†æ</h3><ul>
<li><strong>è¯­æ³•ç†è§£</strong>: æŒæ¡Sui Moveçš„åŸºæœ¬è¯­æ³•å’Œç±»å‹ç³»ç»Ÿ</li>
<li><strong>æ¼æ´è¯†åˆ«</strong>: èƒ½å¤Ÿå‘ç°æ³¨é‡Šä»£ç ã€è®¡è´¹é”™è¯¯ç­‰å¸¸è§æ¼æ´</li>
<li><strong>å¯¹è±¡æ¨¡å‹</strong>: ç†è§£Suiçš„å¯¹è±¡æ‰€æœ‰æƒå’Œè½¬ç§»æœºåˆ¶</li>
<li><strong>äº‹ä»¶ç³»ç»Ÿ</strong>: æŒæ¡äº‹ä»¶çš„è§¦å‘å’Œç›‘å¬æœºåˆ¶</li>
</ul>
<h3 id="2-ç®—æ³•ä¸æ•°æ®ç»“æ„"><a href="#2-ç®—æ³•ä¸æ•°æ®ç»“æ„" class="headerlink" title="2. ç®—æ³•ä¸æ•°æ®ç»“æ„"></a>2. ç®—æ³•ä¸æ•°æ®ç»“æ„</h3><ul>
<li><strong>åŠ¨æ€è§„åˆ’</strong>: æˆ¿å±‹å¼ºç›—é—®é¢˜çš„ç»å…¸DPè§£æ³•åŠå…¶å˜ç§</li>
<li><strong>å›¾è®ºç®—æ³•</strong>: BFSåœ¨è·¯å¾„æœç´¢ä¸­çš„åº”ç”¨</li>
<li><strong>æ ¼ç†è®º</strong>: CVPé—®é¢˜å’ŒLLLç®—æ³•çš„å®é™…åº”ç”¨</li>
<li><strong>æ—¶é—´å¤æ‚åº¦</strong>: ç®—æ³•æ•ˆç‡åˆ†æå’Œä¼˜åŒ–</li>
</ul>
<h3 id="3-å¯†ç å­¦çŸ¥è¯†"><a href="#3-å¯†ç å­¦çŸ¥è¯†" class="headerlink" title="3. å¯†ç å­¦çŸ¥è¯†"></a>3. å¯†ç å­¦çŸ¥è¯†</h3><ul>
<li><strong>LWEé—®é¢˜</strong>: Learning With ErrorsåŠ å¯†æ–¹æ¡ˆçš„åŸç†</li>
<li><strong>æ ¼åŸºçº¦åŒ–</strong>: LLLç®—æ³•å’ŒBabaiç®—æ³•çš„å®ç°</li>
<li><strong>æœ€è¿‘å‘é‡é—®é¢˜</strong>: CVPçš„æ•°å­¦èƒŒæ™¯å’Œè§£å†³æ–¹æ³•</li>
<li><strong>å“ˆå¸Œå‡½æ•°</strong>: Blake2bç­‰å¯†ç å­¦å“ˆå¸Œçš„åº”ç”¨</li>
</ul>
<h3 id="4-åŒºå—é“¾æŠ€æœ¯"><a href="#4-åŒºå—é“¾æŠ€æœ¯" class="headerlink" title="4. åŒºå—é“¾æŠ€æœ¯"></a>4. åŒºå—é“¾æŠ€æœ¯</h3><ul>
<li><strong>Sui CLI</strong>: å‘½ä»¤è¡Œå·¥å…·çš„ç†Ÿç»ƒä½¿ç”¨</li>
<li><strong>PTBæœºåˆ¶</strong>: Programmable Transaction Blockçš„æ„é€ å’Œæ‰§è¡Œ</li>
<li><strong>æ—¶é—´æˆ³æ”»å‡»</strong>: åˆ©ç”¨åŒºå—é“¾æ—¶é—´æˆ³ç‰¹æ€§çš„æ”»å‡»æ–¹æ³•</li>
<li><strong>Gasä¼˜åŒ–</strong>: äº¤æ˜“è´¹ç”¨çš„ä¼°ç®—å’Œä¼˜åŒ–</li>
</ul>
<h2 id="æ”»å‡»æŠ€æœ¯åˆ†ç±»"><a href="#æ”»å‡»æŠ€æœ¯åˆ†ç±»" class="headerlink" title="æ”»å‡»æŠ€æœ¯åˆ†ç±»"></a>æ”»å‡»æŠ€æœ¯åˆ†ç±»</h2><h3 id="1-æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨"><a href="#1-æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨" class="headerlink" title="1. æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨"></a>1. æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨</h3><ul>
<li><strong>ä»£ç å®¡è®¡</strong>: å‘ç°è¢«æ³¨é‡Šçš„å…³é”®ä»£ç </li>
<li><strong>é€»è¾‘é”™è¯¯</strong>: åˆ©ç”¨è®¡è´¹ä¸ä¸€è‡´ç­‰ä¸šåŠ¡é€»è¾‘æ¼æ´</li>
<li><strong>çŠ¶æ€ç®¡ç†</strong>: åˆ©ç”¨çŠ¶æ€æ›´æ–°çš„æ—¶åºé—®é¢˜</li>
<li><strong>æƒé™æ§åˆ¶</strong>: ç»•è¿‡è®¿é—®æ§åˆ¶æœºåˆ¶</li>
</ul>
<h3 id="2-æ—¶é—´ç›¸å…³æ”»å‡»"><a href="#2-æ—¶é—´ç›¸å…³æ”»å‡»" class="headerlink" title="2. æ—¶é—´ç›¸å…³æ”»å‡»"></a>2. æ—¶é—´ç›¸å…³æ”»å‡»</h3><ul>
<li><strong>æ—¶é—´æˆ³ä¾èµ–</strong>: åˆ©ç”¨å¯é¢„æµ‹çš„æ—¶é—´æˆ³ç”Ÿæˆéšæœºæ•°</li>
<li><strong>PTBåŒæ­¥</strong>: ç¡®ä¿æ‰¹é‡æ“ä½œä½¿ç”¨ç›¸åŒæ—¶é—´æˆ³</li>
<li><strong>æ—¶åºæ”»å‡»</strong>: åˆ©ç”¨æ“ä½œæ‰§è¡Œçš„æ—¶é—´å·®</li>
</ul>
<h3 id="3-æ•°å­¦æ”»å‡»"><a href="#3-æ•°å­¦æ”»å‡»" class="headerlink" title="3. æ•°å­¦æ”»å‡»"></a>3. æ•°å­¦æ”»å‡»</h3><ul>
<li><strong>ç®—æ³•é€†å‘</strong>: é€šè¿‡åˆ†æç®—æ³•æ‰¾åˆ°é€†å‘æ±‚è§£æ–¹æ³•</li>
<li><strong>æ¦‚ç‡åˆ†æ</strong>: è®¡ç®—æ”»å‡»æˆåŠŸçš„æ¦‚ç‡å¹¶ä¼˜åŒ–ç­–ç•¥</li>
<li><strong>å¯†ç å­¦æ”»å‡»</strong>: ä½¿ç”¨é«˜çº§æ•°å­¦å·¥å…·ç ´è§£åŠ å¯†æ–¹æ¡ˆ</li>
</ul>
<h3 id="4-è‡ªåŠ¨åŒ–æ”»å‡»"><a href="#4-è‡ªåŠ¨åŒ–æ”»å‡»" class="headerlink" title="4. è‡ªåŠ¨åŒ–æ”»å‡»"></a>4. è‡ªåŠ¨åŒ–æ”»å‡»</h3><ul>
<li><strong>è„šæœ¬ç¼–å†™</strong>: å¼€å‘è‡ªåŠ¨åŒ–æ”»å‡»è„šæœ¬</li>
<li><strong>æ‰¹é‡æ“ä½œ</strong>: é€šè¿‡PTBæ‰§è¡Œå¤§é‡é‡å¤æ“ä½œ</li>
<li><strong>æ¡ä»¶è§¦å‘</strong>: ç­‰å¾…æœ‰åˆ©æ¡ä»¶è‡ªåŠ¨æ‰§è¡Œæ”»å‡»</li>
</ul>
<h2 id="é˜²å¾¡ç­–ç•¥å»ºè®®"><a href="#é˜²å¾¡ç­–ç•¥å»ºè®®" class="headerlink" title="é˜²å¾¡ç­–ç•¥å»ºè®®"></a>é˜²å¾¡ç­–ç•¥å»ºè®®</h2><h3 id="1-ä»£ç å®‰å…¨"><a href="#1-ä»£ç å®‰å…¨" class="headerlink" title="1. ä»£ç å®‰å…¨"></a>1. ä»£ç å®‰å…¨</h3><ul>
<li><strong>å®Œæ•´æ€§æ£€æŸ¥</strong>: ç¡®ä¿æ‰€æœ‰å¿…è¦çš„ä»£ç éƒ½è¢«æ‰§è¡Œ</li>
<li><strong>é€»è¾‘ä¸€è‡´æ€§</strong>: æ£€æŸ¥å’Œæ‰£è´¹é€»è¾‘å¿…é¡»ä¿æŒä¸€è‡´</li>
<li><strong>è¾¹ç•ŒéªŒè¯</strong>: ä¸¥æ ¼éªŒè¯æ‰€æœ‰è¾“å…¥å‚æ•°çš„è¾¹ç•Œæ¡ä»¶</li>
<li><strong>çŠ¶æ€åŒæ­¥</strong>: ç¡®ä¿çŠ¶æ€æ›´æ–°çš„åŸå­æ€§</li>
</ul>
<h3 id="2-éšæœºæ•°å®‰å…¨"><a href="#2-éšæœºæ•°å®‰å…¨" class="headerlink" title="2. éšæœºæ•°å®‰å…¨"></a>2. éšæœºæ•°å®‰å…¨</h3><ul>
<li><strong>çœŸéšæœºæº</strong>: ä½¿ç”¨å¯†ç å­¦å®‰å…¨çš„éšæœºæ•°ç”Ÿæˆå™¨</li>
<li><strong>æ—¶é—´æˆ³é¿å…</strong>: ä¸è¦ä¾èµ–å¯é¢„æµ‹çš„æ—¶é—´æˆ³</li>
<li><strong>ç†µæºå¤šæ ·åŒ–</strong>: ç»“åˆå¤šä¸ªç†µæºç”Ÿæˆéšæœºæ•°</li>
<li><strong>éšæœºæ€§æµ‹è¯•</strong>: å®šæœŸæµ‹è¯•éšæœºæ•°çš„è´¨é‡</li>
</ul>
<h3 id="3-è®¿é—®æ§åˆ¶"><a href="#3-è®¿é—®æ§åˆ¶" class="headerlink" title="3. è®¿é—®æ§åˆ¶"></a>3. è®¿é—®æ§åˆ¶</h3><ul>
<li><strong>æƒé™æœ€å°åŒ–</strong>: åªæˆäºˆå¿…è¦çš„æœ€å°æƒé™</li>
<li><strong>å¤šé‡éªŒè¯</strong>: å…³é”®æ“ä½œéœ€è¦å¤šé‡éªŒè¯</li>
<li><strong>æ—¶é—´é”</strong>: å¯¹é‡è¦æ“ä½œæ·»åŠ æ—¶é—´å»¶è¿Ÿ</li>
<li><strong>é¢‘ç‡é™åˆ¶</strong>: é™åˆ¶é«˜é¢‘æ“ä½œçš„æ‰§è¡Œ</li>
</ul>
<h3 id="4-ç›‘æ§å’Œå®¡è®¡"><a href="#4-ç›‘æ§å’Œå®¡è®¡" class="headerlink" title="4. ç›‘æ§å’Œå®¡è®¡"></a>4. ç›‘æ§å’Œå®¡è®¡</h3><ul>
<li><strong>äº‹ä»¶ç›‘æ§</strong>: å®æ—¶ç›‘æ§å¼‚å¸¸äº‹ä»¶å’Œæ¨¡å¼</li>
<li><strong>äº¤æ˜“åˆ†æ</strong>: åˆ†æå¯ç–‘çš„äº¤æ˜“æ¨¡å¼</li>
<li><strong>ä»£ç å®¡è®¡</strong>: å®šæœŸè¿›è¡Œä¸“ä¸šçš„ä»£ç å®‰å…¨å®¡è®¡</li>
<li><strong>æ¸—é€æµ‹è¯•</strong>: å®šæœŸè¿›è¡Œå®‰å…¨æ¸—é€æµ‹è¯•</li>
</ul>
<h2 id="ç»“è®º"><a href="#ç»“è®º" class="headerlink" title="ç»“è®º"></a>ç»“è®º</h2><p>è¿™å››é“Sui Move CTFé¢˜ç›®å±•ç¤ºäº†åŒºå—é“¾å®‰å…¨çš„å¤šä¸ªé‡è¦æ–¹é¢ï¼š</p>
<ol>
<li><strong>æŠ€æœ¯æ·±åº¦</strong>: ä»åŸºç¡€çš„è·¯å¾„æœç´¢åˆ°é«˜çº§çš„æ ¼ç†è®ºå¯†ç å­¦</li>
<li><strong>æ”»å‡»å¤æ‚æ€§</strong>: ä»å•ä¸€æ¼æ´åˆ©ç”¨åˆ°å¤šæ¼æ´ç»„åˆæ”»å‡»</li>
<li><strong>å·¥å…·å¤šæ ·æ€§</strong>: ä»ç®€å•çš„CLIå·¥å…·åˆ°å¤æ‚çš„æ•°å­¦è½¯ä»¶</li>
<li><strong>æ€ç»´æ–¹å¼</strong>: ä»é€†å‘åˆ†æåˆ°æ­£å‘æ„é€ çš„å®Œæ•´æ€ç»´é“¾</li>
</ol>
<p>é€šè¿‡ç³»ç»Ÿæ€§çš„åˆ†æå’Œæ”»å‡»ï¼Œæˆ‘ä»¬ä¸ä»…è·å¾—äº†æ‰€æœ‰Flagï¼Œæ›´é‡è¦çš„æ˜¯ï¼š</p>
<ul>
<li>æ·±å…¥ç†è§£äº†Moveæ™ºèƒ½åˆçº¦çš„å®‰å…¨ç‰¹æ€§</li>
<li>æŒæ¡äº†å¤šç§æ”»å‡»æŠ€æœ¯å’Œé˜²å¾¡ç­–ç•¥</li>
<li>æé«˜äº†ç»¼åˆçš„å®‰å…¨åˆ†æå’Œè§£å†³é—®é¢˜çš„èƒ½åŠ›</li>
<li>å»ºç«‹äº†å®Œæ•´çš„åŒºå—é“¾å®‰å…¨çŸ¥è¯†ä½“ç³»</li>
</ul>
<p>è¿™äº›æŠ€èƒ½å’Œç»éªŒå¯¹äºåŒºå—é“¾å®‰å…¨ç ”ç©¶ã€æ™ºèƒ½åˆçº¦å®¡è®¡ã€ä»¥åŠWeb3å®‰å…¨é˜²æŠ¤éƒ½å…·æœ‰é‡è¦çš„å®è·µä»·å€¼ã€‚éšç€åŒºå—é“¾æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼Œè¿™ç±»ç»¼åˆæ€§çš„å®‰å…¨æŒ‘æˆ˜å°†å˜å¾—è¶Šæ¥è¶Šé‡è¦ï¼Œéœ€è¦æˆ‘ä»¬æŒç»­å­¦ä¹ å’Œå®è·µã€‚</p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2025/04/28/How%20To%20Define%20a%20Referenced%20Sound/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>Prev</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
              2025-08-05 16:32:21
            </span>
            
          </div>
          <div class="post-foot-prev">
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">Contents</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Sui-Move-CTF-2025-1-4-WriteUp"><span class="toc-text">Sui Move CTF 2025(1-4) WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95"><span class="toc-text">ç›®å½•</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%86%92%E9%99%A9%E6%B8%B8%E6%88%8F"><span class="toc-text">1. å†’é™©æ¸¸æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8C%91%E6%88%98%E6%A6%82%E8%BF%B0"><span class="toc-text">æŒ‘æˆ˜æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%88%E7%BA%A6%E5%88%86%E6%9E%90"><span class="toc-text">åˆçº¦åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%90%88%E7%BA%A6%E7%BB%93%E6%9E%84"><span class="toc-text">æ ¸å¿ƒåˆçº¦ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%BC%8F%E6%B4%9E%E5%8F%91%E7%8E%B0"><span class="toc-text">å…³é”®æ¼æ´å‘ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BD%93%E5%8A%9B%E6%B6%88%E8%80%97%E6%BC%8F%E6%B4%9E"><span class="toc-text">1. ä½“åŠ›æ¶ˆè€—æ¼æ´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%97%B6%E9%97%B4%E6%88%B3%E4%BE%9D%E8%B5%96%E6%BC%8F%E6%B4%9E"><span class="toc-text">2. æ—¶é—´æˆ³ä¾èµ–æ¼æ´</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%AE%A1%E8%B4%B9%E9%94%99%E8%AF%AF%E6%BC%8F%E6%B4%9E"><span class="toc-text">3. è®¡è´¹é”™è¯¯æ¼æ´</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E7%AD%96%E7%95%A5"><span class="toc-text">æ”»å‡»ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B51-%E8%8B%B1%E9%9B%84%E6%88%98%E6%96%97%E5%8A%9B%E6%8F%90%E5%8D%87"><span class="toc-text">é˜¶æ®µ1: è‹±é›„æˆ˜æ–—åŠ›æå‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B52-PTB%E6%97%B6%E9%97%B4%E6%88%B3%E6%94%BB%E5%87%BB"><span class="toc-text">é˜¶æ®µ2: PTBæ—¶é—´æˆ³æ”»å‡»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B6%E6%AE%B53-%E8%B4%AD%E4%B9%B0%E5%AE%9D%E7%AE%B1%E8%8E%B7%E5%8F%96Flag"><span class="toc-text">é˜¶æ®µ3: è´­ä¹°å®ç®±è·å–Flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E5%AE%9E%E7%8E%B0"><span class="toc-text">æ”»å‡»å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8B%B1%E9%9B%84%E5%8D%87%E7%BA%A7%E8%84%9A%E6%9C%AC"><span class="toc-text">è‹±é›„å‡çº§è„šæœ¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PTB%E6%89%B9%E9%87%8F%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC"><span class="toc-text">PTBæ‰¹é‡æ”»å‡»è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B"><span class="toc-text">æ”»å‡»æ‰§è¡Œè¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">1. ç¯å¢ƒå‡†å¤‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%8B%B1%E9%9B%84%E5%8D%87%E7%BA%A7"><span class="toc-text">2. è‹±é›„å‡çº§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-PTB%E6%94%BB%E5%87%BB"><span class="toc-text">3. PTBæ”»å‡»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%8E%B7%E5%8F%96Flag"><span class="toc-text">4. è·å–Flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E7%BB%93%E6%9E%9C"><span class="toc-text">æ”»å‡»ç»“æœ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E8%A6%81%E7%82%B9%E6%80%BB%E7%BB%93"><span class="toc-text">æŠ€æœ¯è¦ç‚¹æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E5%BB%BA%E8%AE%AE"><span class="toc-text">é˜²å¾¡å»ºè®®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90"><span class="toc-text">è¯¦ç»†æŠ€æœ¯åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E6%88%B3%E6%94%BB%E5%87%BB%E5%8E%9F%E7%90%86"><span class="toc-text">æ—¶é—´æˆ³æ”»å‡»åŸç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PTB%E6%9E%84%E9%80%A0%E6%8A%80%E5%B7%A7"><span class="toc-text">PTBæ„é€ æŠ€å·§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8B%B1%E9%9B%84%E5%8D%87%E7%BA%A7%E6%95%B0%E5%80%BC%E5%88%86%E6%9E%90"><span class="toc-text">è‹±é›„å‡çº§æ•°å€¼åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%97%B6%E9%97%B4%E7%BA%BF"><span class="toc-text">æ”»å‡»æ—¶é—´çº¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E7%89%87%E6%AE%B5"><span class="toc-text">å…³é”®ä»£ç ç‰‡æ®µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BB%A3%E7%A0%811-%E4%BD%93%E5%8A%9B%E6%B6%88%E8%80%97%E8%A2%AB%E6%B3%A8%E9%87%8A"><span class="toc-text">æ¼æ´ä»£ç 1: ä½“åŠ›æ¶ˆè€—è¢«æ³¨é‡Š</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BB%A3%E7%A0%812-%E6%97%B6%E9%97%B4%E6%88%B3%E4%BE%9D%E8%B5%96"><span class="toc-text">æ¼æ´ä»£ç 2: æ—¶é—´æˆ³ä¾èµ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E4%BB%A3%E7%A0%813-%E8%AE%A1%E8%B4%B9%E9%94%99%E8%AF%AF"><span class="toc-text">æ¼æ´ä»£ç 3: è®¡è´¹é”™è¯¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%8C%E6%95%B4%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%AC"><span class="toc-text">å®Œæ•´æ”»å‡»è„šæœ¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E8%A6%81%E7%82%B9"><span class="toc-text">å­¦ä¹ è¦ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E8%B5%84%E6%BA%90"><span class="toc-text">ç›¸å…³èµ„æº</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%BC%BA%E7%9B%97%E6%B8%B8%E6%88%8F"><span class="toc-text">2. å¼ºç›—æ¸¸æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%BF%A1%E6%81%AF"><span class="toc-text">é¢˜ç›®ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%8F%8F%E8%BF%B0"><span class="toc-text">é¢˜ç›®æè¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF"><span class="toc-text">è§£é¢˜æ€è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%90%88%E7%BA%A6%E5%88%86%E6%9E%90"><span class="toc-text">1. åˆçº¦åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%AE%97%E6%B3%95%E7%90%86%E8%A7%A3"><span class="toc-text">2. ç®—æ³•ç†è§£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%A7%A3%E9%A2%98%E8%84%9A%E6%9C%AC"><span class="toc-text">3. è§£é¢˜è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%AD%A5%E9%AA%A4"><span class="toc-text">è§£é¢˜æ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9D%E5%A7%8B%E5%8C%96%E6%B8%B8%E6%88%8F"><span class="toc-text">1. åˆå§‹åŒ–æ¸¸æˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8BChallenge%E5%AF%B9%E8%B1%A1"><span class="toc-text">2. æŸ¥çœ‹Challengeå¯¹è±¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%AE%A1%E7%AE%97%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">3. è®¡ç®—è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%8E%B7%E5%8F%96Flag-1"><span class="toc-text">4. è·å–Flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E7%BB%93%E6%9E%9C"><span class="toc-text">è§£é¢˜ç»“æœ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E7%82%B9"><span class="toc-text">å…³é”®æŠ€æœ¯ç‚¹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%81%A2%E5%A4%8D%E5%AF%86%E9%92%A5"><span class="toc-text">3. æ¢å¤å¯†é’¥</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%BF%A1%E6%81%AF-1"><span class="toc-text">é¢˜ç›®ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E7%8E%AF%E5%A2%83"><span class="toc-text">é¢˜ç›®ç¯å¢ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF-1"><span class="toc-text">è§£é¢˜æ€è·¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90"><span class="toc-text">1. é¢˜ç›®åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81%E5%88%86%E6%9E%90"><span class="toc-text">2. å…³é”®ä»£ç åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%8E%9F%E7%90%86"><span class="toc-text">3. å¯†ç å­¦åŸç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E6%AD%A5%E9%AA%A4-1"><span class="toc-text">è§£é¢˜æ­¥éª¤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A41-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-text">æ­¥éª¤1: ç¯å¢ƒå‡†å¤‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A42-%E5%88%86%E6%9E%90%E5%AF%86%E6%96%87"><span class="toc-text">æ­¥éª¤2: åˆ†æå¯†æ–‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A43-%E4%BD%BF%E7%94%A8CVP%E7%AE%97%E6%B3%95%E8%A7%A3%E5%AF%86"><span class="toc-text">æ­¥éª¤3: ä½¿ç”¨CVPç®—æ³•è§£å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A44-%E8%BF%90%E8%A1%8C%E8%A7%A3%E5%AF%86%E8%84%9A%E6%9C%AC"><span class="toc-text">æ­¥éª¤4: è¿è¡Œè§£å¯†è„šæœ¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A45-%E9%AA%8C%E8%AF%81flag"><span class="toc-text">æ­¥éª¤5: éªŒè¯flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E7%BB%93%E6%9E%9C-1"><span class="toc-text">è§£é¢˜ç»“æœ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E8%A6%81%E7%82%B9"><span class="toc-text">æŠ€æœ¯è¦ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%A0%BC%E7%90%86%E8%AE%BA%E5%9F%BA%E7%A1%80"><span class="toc-text">1. æ ¼ç†è®ºåŸºç¡€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Babai%E7%AE%97%E6%B3%95"><span class="toc-text">2. Babaiç®—æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Move%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">3. Moveæ™ºèƒ½åˆçº¦</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-1"><span class="toc-text">æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E8%BF%B7%E5%AE%AB%E6%B8%B8%E6%88%8F"><span class="toc-text">4. è¿·å®«æ¸¸æˆ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E4%BF%A1%E6%81%AF-2"><span class="toc-text">é¢˜ç›®ä¿¡æ¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E5%88%86%E6%9E%90"><span class="toc-text">é¢˜ç›®åˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%90%88%E7%BA%A6%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="toc-text">1. åˆçº¦ç»“æ„åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%BF%B7%E5%AE%AB%E5%B8%83%E5%B1%80"><span class="toc-text">2. è¿·å®«å¸ƒå±€</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%B8%B8%E6%88%8F%E6%9C%BA%E5%88%B6"><span class="toc-text">3. æ¸¸æˆæœºåˆ¶</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-text">è§£é¢˜è¿‡ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A41-%E8%BF%B7%E5%AE%AB%E8%B7%AF%E5%BE%84%E5%88%86%E6%9E%90"><span class="toc-text">æ­¥éª¤1: è¿·å®«è·¯å¾„åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A42-%E8%B7%AF%E5%BE%84%E6%90%9C%E7%B4%A2%E7%AE%97%E6%B3%95"><span class="toc-text">æ­¥éª¤2: è·¯å¾„æœç´¢ç®—æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A43-%E6%89%BE%E5%88%B0%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-text">æ­¥éª¤3: æ‰¾åˆ°è§£å†³æ–¹æ¡ˆ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%93%BE%E4%B8%8A%E6%89%A7%E8%A1%8C"><span class="toc-text">é“¾ä¸Šæ‰§è¡Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A41-%E5%88%9B%E5%BB%BA%E6%8C%91%E6%88%98"><span class="toc-text">æ­¥éª¤1: åˆ›å»ºæŒ‘æˆ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A42-%E5%AE%8C%E6%88%90%E8%BF%B7%E5%AE%AB%E6%8C%91%E6%88%98"><span class="toc-text">æ­¥éª¤2: å®Œæˆè¿·å®«æŒ‘æˆ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A43-%E8%8E%B7%E5%8F%96Flag"><span class="toc-text">æ­¥éª¤3: è·å–Flag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E7%82%B9-1"><span class="toc-text">å…³é”®æŠ€æœ¯ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Move%E5%90%88%E7%BA%A6%E5%88%86%E6%9E%90"><span class="toc-text">1. Moveåˆçº¦åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%AE%97%E6%B3%95%E5%BA%94%E7%94%A8"><span class="toc-text">2. ç®—æ³•åº”ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8C%BA%E5%9D%97%E9%93%BE%E4%BA%A4%E4%BA%92"><span class="toc-text">3. åŒºå—é“¾äº¤äº’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-text">4. æ•°æ®è½¬æ¢</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93-2"><span class="toc-text">æ€»ç»“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A5%E5%85%B7%E5%92%8C%E8%84%9A%E6%9C%AC"><span class="toc-text">å·¥å…·å’Œè„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%BB%BC%E5%90%88%E6%8A%80%E6%9C%AF%E6%80%BB%E7%BB%93"><span class="toc-text">ç»¼åˆæŠ€æœ¯æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%8A%80%E8%83%BD%E7%9F%A9%E9%98%B5"><span class="toc-text">æ ¸å¿ƒæŠ€èƒ½çŸ©é˜µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Move%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E5%88%86%E6%9E%90"><span class="toc-text">1. Moveæ™ºèƒ½åˆçº¦åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%AE%97%E6%B3%95%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="toc-text">2. ç®—æ³•ä¸æ•°æ®ç»“æ„</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9F%A5%E8%AF%86"><span class="toc-text">3. å¯†ç å­¦çŸ¥è¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%8C%BA%E5%9D%97%E9%93%BE%E6%8A%80%E6%9C%AF"><span class="toc-text">4. åŒºå—é“¾æŠ€æœ¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%8A%80%E6%9C%AF%E5%88%86%E7%B1%BB"><span class="toc-text">æ”»å‡»æŠ€æœ¯åˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-text">1. æ™ºèƒ½åˆçº¦æ¼æ´åˆ©ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%97%B6%E9%97%B4%E7%9B%B8%E5%85%B3%E6%94%BB%E5%87%BB"><span class="toc-text">2. æ—¶é—´ç›¸å…³æ”»å‡»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E5%AD%A6%E6%94%BB%E5%87%BB"><span class="toc-text">3. æ•°å­¦æ”»å‡»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%94%BB%E5%87%BB"><span class="toc-text">4. è‡ªåŠ¨åŒ–æ”»å‡»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%98%B2%E5%BE%A1%E7%AD%96%E7%95%A5%E5%BB%BA%E8%AE%AE"><span class="toc-text">é˜²å¾¡ç­–ç•¥å»ºè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8"><span class="toc-text">1. ä»£ç å®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%AE%89%E5%85%A8"><span class="toc-text">2. éšæœºæ•°å®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="toc-text">3. è®¿é—®æ§åˆ¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%9B%91%E6%8E%A7%E5%92%8C%E5%AE%A1%E8%AE%A1"><span class="toc-text">4. ç›‘æ§å’Œå®¡è®¡</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-text">ç»“è®º</span></a></li></ol></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" target="_blank" rel="noopener" href="https://github.com/DudeGuuud">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
        <li>
          
              <a title="rss" href="/rss.xml">
                <i class="iconfont icon-rss"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/DudeGuuud">Copyright Â© 2025 DudeGuuud</a>
        
    </div>
  
    
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="æœç´¢æ–‡ç« ...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>First search, index file loading, please wait...<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>No result<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The search.xml file was not found, please refer toï¼š<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The request failed, Try to refresh the page or try again later.<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + SUI%20MOVE%20CTF%202025%20(1-4)%20Write%20Up + '&url=' + http%3A%2F%2Fexample.com%2F2025%2F08%2F05%2FMOVE%2520CTF%25202025%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=http://example.com/2025/08/05/MOVE%20CTF%202025/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
